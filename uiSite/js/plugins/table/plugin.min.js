/**
 * Copyright (c) Tiny Technologies, Inc. All rights reserved.
 * Licensed under the LGPL or a commercial license.
 * For LGPL see License.txt in the project root for license information.
 * For commercial licenses see https://www.tiny.cloud/
 *
 * Version: 5.6.0 (TBD)
 */
!function(){"use strict";var y=function(){},b=function(n){return function(){return n}},u=function(n){return n};function w(r){for(var o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=o.concat(n);return r.apply(null,t)}}var n,e,t,d=function(e){return function(n){return!e(n)}},f=b(!1),C=b(!0),r=function(){return i},i=(n=function(n){return n.isNone()},{fold:function(n,e){return n()},is:f,isSome:f,isNone:C,getOr:t=function(n){return n},getOrThunk:e=function(n){return n()},getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:b(null),getOrUndefined:b(undefined),or:t,orThunk:e,map:r,each:y,bind:r,exists:f,forall:C,filter:r,equals:n,equals_:n,toArray:function(){return[]},toString:b("none()")}),c=function(t){var n=b(t),e=function(){return o},r=function(n){return n(t)},o={fold:function(n,e){return e(t)},is:function(n){return t===n},isSome:C,isNone:f,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(n){return c(n(t))},each:function(n){n(t)},bind:r,exists:r,forall:r,filter:function(n){return n(t)?o:i},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(n){return n.is(t)},equals_:function(n,e){return n.fold(f,function(n){return e(t,n)})}};return o},S={some:c,none:r,from:function(n){return null===n||n===undefined?i:c(n)}},o=function(r){return function(n){return t=typeof(e=n),(null===e?"null":"object"==t&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":t)===r;var e,t}},a=function(e){return function(n){return typeof n===e}},p=o("string"),m=o("object"),l=o("array"),s=a("boolean"),g=function(n){return!(null===(e=n)||e===undefined);var e},h=a("function"),v=a("number"),x=Array.prototype.slice,T=Array.prototype.indexOf,R=Array.prototype.push,D=function(n,e){return t=n,r=e,-1<T.call(t,r);var t,r},O=function(n,e){for(var t=0,r=n.length;t<r;t++){if(e(n[t],t))return!0}return!1},A=function(n,e){for(var t=[],r=0;r<n;r++)t.push(e(r));return t},B=function(n,e){for(var t=n.length,r=new Array(t),o=0;o<t;o++){var u=n[o];r[o]=e(u,o)}return r},E=function(n,e){for(var t=0,r=n.length;t<r;t++){e(n[t],t)}},I=function(n,e){for(var t=[],r=0,o=n.length;r<o;r++){var u=n[r];e(u,r)&&t.push(u)}return t},P=function(n,e,t){return function(n,e){for(var t=n.length-1;0<=t;t--){e(n[t],t)}}(n,function(n){t=e(t,n)}),t},k=function(n,e,t){return E(n,function(n){t=e(t,n)}),t},M=function(n,e){return function(n,e,t){for(var r=0,o=n.length;r<o;r++){var u=n[r];if(e(u,r))return S.some(u);if(t(u,r))break}return S.none()}(n,e,f)},N=function(n,e){for(var t=0,r=n.length;t<r;t++){if(e(n[t],t))return S.some(t)}return S.none()},j=function(n){for(var e=[],t=0,r=n.length;t<r;++t){if(!l(n[t]))throw new Error("Arr.flatten item "+t+" was not an array, input: "+n);R.apply(e,n[t])}return e},_=function(n,e){return j(B(n,e))},z=function(n,e){for(var t=0,r=n.length;t<r;++t){if(!0!==e(n[t],t))return!1}return!0},W=function(n){return[n]},F=function(n){return 0===n.length?S.none():S.some(n[n.length-1])},L=function(n,e){for(var t=0;t<n.length;t++){var r=e(n[t],t);if(r.isSome())return r}return S.none()},H=function(){return(H=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++)for(var o in e=arguments[t])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}).apply(this,arguments)};function q(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),o=0,e=0;e<t;e++)for(var u=arguments[e],i=0,c=u.length;i<c;i++,o++)r[o]=u[i];return r}var V,U=function(t){var r,o=!1;return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return o||(o=!0,r=t.apply(null,n)),r}},$=function(n,e){var t=function(n,e){for(var t=0;t<n.length;t++){var r=n[t];if(r.test(e))return r}return undefined}(n,e);if(!t)return{major:0,minor:0};var r=function(n){return Number(e.replace(t,"$"+n))};return K(r(1),r(2))},G=function(){return K(0,0)},K=function(n,e){return{major:n,minor:e}},X={nu:K,detect:function(n,e){var t=String(e).toLowerCase();return 0===n.length?G():$(n,t)},unknown:G},Y=function(n,e){var t=String(e).toLowerCase();return M(n,function(n){return n.search(t)})},J=function(n,t){return Y(n,t).map(function(n){var e=X.detect(n.versionRegexes,t);return{current:n.name,version:e}})},Q=function(n,t){return Y(n,t).map(function(n){var e=X.detect(n.versionRegexes,t);return{current:n.name,version:e}})},Z=function(n,e,t){return""===e||n.length>=e.length&&n.substr(t,t+e.length)===e},nn=function(n,e){return-1!==n.indexOf(e)},en=function(n,e){return Z(n,e,0)},tn=function(n,e){return Z(n,e,n.length-e.length)},rn=(V=/^\s+|\s+$/g,function(n){return n.replace(V,"")}),on=function(n){return 0<n.length},un=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,cn=function(e){return function(n){return nn(n,e)}},an=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return nn(n,"edge/")&&nn(n,"chrome")&&nn(n,"safari")&&nn(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,un],search:function(n){return nn(n,"chrome")&&!nn(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return nn(n,"msie")||nn(n,"trident")}},{name:"Opera",versionRegexes:[un,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:cn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:cn("firefox")},{name:"Safari",versionRegexes:[un,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(nn(n,"safari")||nn(n,"mobile/"))&&nn(n,"applewebkit")}}],ln=[{name:"Windows",search:cn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return nn(n,"iphone")||nn(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:cn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:cn("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:cn("linux"),versionRegexes:[]},{name:"Solaris",search:cn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:cn("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:cn("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],fn={browsers:b(an),oses:b(ln)},sn="Firefox",dn=function(n){var e=n.current,t=n.version,r=function(n){return function(){return e===n}};return{current:e,version:t,isEdge:r("Edge"),isChrome:r("Chrome"),isIE:r("IE"),isOpera:r("Opera"),isFirefox:r(sn),isSafari:r("Safari")}},mn={unknown:function(){return dn({current:undefined,version:X.unknown()})},nu:dn,edge:b("Edge"),chrome:b("Chrome"),ie:b("IE"),opera:b("Opera"),firefox:b(sn),safari:b("Safari")},gn="Windows",pn="Android",hn="Solaris",vn="FreeBSD",bn="ChromeOS",wn=function(n){var e=n.current,t=n.version,r=function(n){return function(){return e===n}};return{current:e,version:t,isWindows:r(gn),isiOS:r("iOS"),isAndroid:r(pn),isOSX:r("OSX"),isLinux:r("Linux"),isSolaris:r(hn),isFreeBSD:r(vn),isChromeOS:r(bn)}},yn={unknown:function(){return wn({current:undefined,version:X.unknown()})},nu:wn,windows:b(gn),ios:b("iOS"),android:b(pn),linux:b("Linux"),osx:b("OSX"),solaris:b(hn),freebsd:b(vn),chromeos:b(bn)},Cn=function(n,e){var t,r,o,u,i,c,a,l,f,s,d,m,g=fn.browsers(),p=fn.oses(),h=J(g,n).fold(mn.unknown,mn.nu),v=Q(p,n).fold(yn.unknown,yn.nu);return{browser:h,os:v,deviceType:(r=h,o=n,u=e,i=(t=v).isiOS()&&!0===/ipad/i.test(o),c=t.isiOS()&&!i,a=t.isiOS()||t.isAndroid(),l=a||u("(pointer:coarse)"),f=i||!c&&a&&u("(min-device-width:768px)"),s=c||a&&!f,d=r.isSafari()&&t.isiOS()&&!1===/safari/i.test(o),m=!s&&!f&&!d,{isiPad:b(i),isiPhone:b(c),isTablet:b(f),isPhone:b(s),isTouch:b(l),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:b(d),isDesktop:b(m)})}},Sn=function(n){return window.matchMedia(n).matches},xn=U(function(){return Cn(navigator.userAgent,Sn)}),Tn=function(){return xn()},Rn=function(n){if(null===n||n===undefined)throw new Error("Node cannot be null or undefined");return{dom:n}},Dn={fromHtml:function(n,e){var t=(e||document).createElement("div");if(t.innerHTML=n,!t.hasChildNodes()||1<t.childNodes.length)throw console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return Rn(t.childNodes[0])},fromTag:function(n,e){var t=(e||document).createElement(n);return Rn(t)},fromText:function(n,e){var t=(e||document).createTextNode(n);return Rn(t)},fromDom:Rn,fromPoint:function(n,e,t){return S.from(n.dom.elementFromPoint(e,t)).map(Rn)}},On=function(n,e){var t=n.dom;if(1!==t.nodeType)return!1;var r=t;if(r.matches!==undefined)return r.matches(e);if(r.msMatchesSelector!==undefined)return r.msMatchesSelector(e);if(r.webkitMatchesSelector!==undefined)return r.webkitMatchesSelector(e);if(r.mozMatchesSelector!==undefined)return r.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")},An=function(n){return 1!==n.nodeType&&9!==n.nodeType&&11!==n.nodeType||0===n.childElementCount},Bn=function(n,e){return n.dom===e.dom},En=function(n,e){return t=n.dom,r=e.dom,o=t,u=r,i=Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(o.compareDocumentPosition(u)&i);var t,r,o,u,i},In=function(n,e){return Tn().browser.isIE()?En(n,e):(t=e,r=n.dom,o=t.dom,r!==o&&r.contains(o));var t,r,o},Pn=On,kn=Object.keys,Mn=Object.hasOwnProperty,Nn=function(n,e){for(var t=kn(n),r=0,o=t.length;r<o;r++){var u=t[r];e(n[u],u)}},jn=function(n,t){return _n(n,function(n,e){return{k:e,v:t(n,e)}})},_n=function(n,r){var o={};return Nn(n,function(n,e){var t=r(n,e);o[t.k]=t.v}),o},zn=function(n,e){var t,r,o,u,i={};return t=e,u=i,r=function(n,e){u[e]=n},o=y,Nn(n,function(n,e){(t(n,e)?r:o)(n,e)}),i},Wn=function(n){return t=function(n){return n},r=[],Nn(n,function(n,e){r.push(t(n,e))}),r;var t,r},Fn=function(n,e){return Ln(n,e)?S.from(n[e]):S.none()},Ln=function(n,e){return Mn.call(n,e)},Hn=["tfoot","thead","tbody","colgroup"],qn=function(n,e,t){return{element:n,rowspan:e,colspan:t}},Vn=function(n,e,t){return{element:n,cells:e,section:t}},Un=function(n,e){return{element:n,isNew:e}},$n=function(n,e){return{cells:n,section:e}},Gn=("undefined"!=typeof window||Function("return this;")(),function(n){return n.dom.nodeName.toLowerCase()}),Kn=function(n){return n.dom.nodeType},Xn=function(e){return function(n){return Kn(n)===e}},Yn=function(n){return 8===Kn(n)||"#comment"===Gn(n)},Jn=Xn(1),Qn=Xn(3),Zn=Xn(9),ne=Xn(11),ee=function(n){return Dn.fromDom(n.dom.ownerDocument)},te=function(n){return Zn(n)?n:ee(n)},re=function(n){return S.from(n.dom.parentNode).map(Dn.fromDom)},oe=function(n,e){for(var t=h(e)?e:f,r=n.dom,o=[];null!==r.parentNode&&r.parentNode!==undefined;){var u=r.parentNode,i=Dn.fromDom(u);if(o.push(i),!0===t(i))break;r=u}return o},ue=function(n){return S.from(n.dom.previousSibling).map(Dn.fromDom)},ie=function(n){return S.from(n.dom.nextSibling).map(Dn.fromDom)},ce=function(n){return B(n.dom.childNodes,Dn.fromDom)},ae=function(n,e){var t=n.dom.childNodes;return S.from(t[e]).map(Dn.fromDom)},le=h(Element.prototype.attachShadow)&&h(Node.prototype.getRootNode),fe=b(le),se=le?function(n){return Dn.fromDom(n.dom.getRootNode())}:te,de=function(n){var e=se(n);return ne(e)?S.some(e):S.none()},me=function(n){return Dn.fromDom(n.dom.host)},ge=function(n){if(fe()&&g(n.target)){var e=Dn.fromDom(n.target);if(Jn(e)&&pe(e)&&n.composed&&n.composedPath){var t=n.composedPath();if(t)return 0===(r=t).length?S.none():S.some(r[0])}}var r;return S.from(n.target)},pe=function(n){return g(n.dom.shadowRoot)},he=function(n){var e=Qn(n)?n.dom.parentNode:n.dom;if(e===undefined||null===e||null===e.ownerDocument)return!1;var t,r,o=e.ownerDocument;return de(Dn.fromDom(e)).fold(function(){return o.body.contains(e)},(t=he,r=me,function(n){return t(r(n))}))},ve=function(n){var e=n.dom.body;if(null===e||e===undefined)throw new Error("Body is not available yet");return Dn.fromDom(e)},be=function(n,e){var t=[];return E(ce(n),function(n){e(n)&&(t=t.concat([n])),t=t.concat(be(n,e))}),t},we=function(n,e,t){return r=function(n){return On(n,e)},I(oe(n,t),r);var r},ye=function(n,e){return t=function(n){return On(n,e)},I(ce(n),t);var t},Ce=function(n,e){return t=e,o=(r=n)===undefined?document:r.dom,An(o)?[]:B(o.querySelectorAll(t),Dn.fromDom);var t,r,o};function Se(n,e,t,r,o){return n(t,r)?S.some(t):h(o)&&o(t)?S.none():e(t,r,o)}var xe=function(n,e,t){for(var r=n.dom,o=h(t)?t:f;r.parentNode;){r=r.parentNode;var u=Dn.fromDom(r);if(e(u))return S.some(u);if(o(u))break}return S.none()},Te=function(n,e,t){return xe(n,function(n){return On(n,e)},t)},Re=function(n,e){return t=function(n){return On(n,e)},M(n.dom.childNodes,function(n){return t(Dn.fromDom(n))}).map(Dn.fromDom);var t},De=function(n,e){return t=e,o=(r=n)===undefined?document:r.dom,An(o)?S.none():S.from(o.querySelector(t)).map(Dn.fromDom);var t,r,o},Oe=function(n,e,t){return Se(On,Te,n,e,t)},Ae=function(n,e,t){if(!(p(t)||s(t)||v(t)))throw console.error("Invalid call to Attribute.set. Key ",e,":: Value ",t,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,t+"")},Be=function(n,e,t){Ae(n.dom,e,t)},Ee=function(n,e){var t=n.dom;Nn(e,function(n,e){Ae(t,e,n)})},Ie=function(n,e){var t=n.dom.getAttribute(e);return null===t?undefined:t},Pe=function(n,e){return S.from(Ie(n,e))},ke=function(n,e){n.dom.removeAttribute(e)},Me=function(n){return k(n.dom.attributes,function(n,e){return n[e.name]=e.value,n},{})},Ne=function(n){return n.style!==undefined&&h(n.style.getPropertyValue)},je=function(n,e,t){if(!p(t))throw console.error("Invalid call to CSS.set. Property ",e,":: Value ",t,":: Element ",n),new Error("CSS value must be a string: "+t);Ne(n)&&n.style.setProperty(e,t)},_e=function(n,e,t){var r=n.dom;je(r,e,t)},ze=function(n,e){var t=n.dom;Nn(e,function(n,e){je(t,e,n)})},We=function(n,e){var t=n.dom,r=window.getComputedStyle(t).getPropertyValue(e);return""!==r||he(n)?r:Fe(t,e)},Fe=function(n,e){return Ne(n)?n.style.getPropertyValue(e):""},Le=function(n,e){var t=n.dom,r=Fe(t,e);return S.from(r).filter(function(n){return 0<n.length})},He=function(n,e){var t,r,o=n.dom;r=e,Ne(t=o)&&t.style.removeProperty(r),Pe(n,"style").map(rn).is("")&&ke(n,"style")},qe=function(n,e,t){return void 0===t&&(t=0),Pe(n,e).map(function(n){return parseInt(n,10)}).getOr(t)},Ve=function(n,e){return qe(n,e,1)},Ue=function(n){return 1<Ve(n,"colspan")},$e=function(n){return 1<Ve(n,"rowspan")},Ge=function(n,e){return parseInt(We(n,e),10)},Ke=b(10),Xe=b(10),Ye=function(n,e){return Je(n,e,C)},Je=function(n,e,t){return _(ce(n),function(n){return On(n,e)?t(n)?[n]:[]:Je(n,e,t)})},Qe=function(n,e){return function(n,e,t){if(void 0===t&&(t=f),t(e))return S.none();if(D(n,Gn(e)))return S.some(e);return Te(e,n.join(","),function(n){return On(n,"table")||t(n)})}(["td","th"],n,e)},Ze=function(n){return Ye(n,"th,td")},nt=function(n){return _(rt(n),function(n){return ye(n,"col")})},et=function(n,e){return Oe(n,"table",e)},tt=function(n){return Ye(n,"tr")},rt=function(n){return et(n).fold(b([]),function(n){return ye(n,"colgroup")})},ot=function(n,t){return B(n,function(n){if("colgroup"===Gn(n)){var e=B(nt(n),function(n){var e=qe(n,"span",1);return qn(n,1,e)});return Vn(n,e,"colgroup")}e=B(Ze(n),function(n){var e=qe(n,"rowspan",1),t=qe(n,"colspan",1);return qn(n,e,t)});return Vn(n,e,t(n))})},ut=function(n){return re(n).map(function(n){var e=Gn(n);return D(Hn,e)?e:"tbody"}).getOr("tbody")},it=function(n){var e=tt(n),t=q(rt(n),e);return ot(t,ut)},ct=function(n,e){return n+","+e},at=function(n,e){var t=_(n.all,function(n){return n.cells});return I(t,e)},lt=function(n){var a={},e=[],t={},r=0,l=0,f=0;return E(n,function(n){var c,o,u;"colgroup"===n.section?(o={},u=0,E(n.cells,function(t){var r=t.colspan;A(r,function(n){var e=u+n;o[e]={element:t.element,colspan:r,column:e}}),u+=r}),t=o):(c=[],E(n.cells,function(n){for(var e=0;a[ct(f,e)]!==undefined;)e++;for(var t={element:n.element,rowspan:n.rowspan,colspan:n.colspan,row:f,column:e},r=0;r<n.colspan;r++)for(var o=0;o<n.rowspan;o++){var u=e+r,i=ct(f+o,u);a[i]=t,l=Math.max(l,u+1)}c.push(t)}),r++,e.push(Vn(n.element,c,n.section)),f++)}),{grid:{rows:r,columns:l},access:a,all:e,columns:t}},ft={fromTable:function(n){var e=it(n);return lt(e)},generate:lt,getAt:function(n,e,t){var r=n.access[ct(e,t)];return r!==undefined?S.some(r):S.none()},findItem:function(n,e,t){var r=at(n,function(n){return t(e,n.element)});return 0<r.length?S.some(r[0]):S.none()},filterItems:at,justCells:function(n){return _(n.all,function(n){return n.cells})},justColumns:function(n){return Wn(n.columns)},hasColumns:function(n){return 0<kn(n.columns).length},getColumnAt:function(n,e){return S.from(n.columns[e])}},st=function(n,e){var t=e.column,r=e.column+e.colspan-1,o=e.row,u=e.row+e.rowspan-1;return t<=n.finishCol&&r>=n.startCol&&o<=n.finishRow&&u>=n.startRow},dt=function(n,e){return e.column>=n.startCol&&e.column+e.colspan-1<=n.finishCol&&e.row>=n.startRow&&e.row+e.rowspan-1<=n.finishRow},mt=function(n,e,t){var r=ft.findItem(n,e,Bn),o=ft.findItem(n,t,Bn);return r.bind(function(r){return o.map(function(n){return e=r,t=n,{startRow:Math.min(e.row,t.row),startCol:Math.min(e.column,t.column),finishRow:Math.max(e.row+e.rowspan-1,t.row+t.rowspan-1),finishCol:Math.max(e.column+e.colspan-1,t.column+t.colspan-1)};var e,t})})},gt=function(e,n,t){return mt(e,n,t).bind(function(n){return function(n,e){for(var t=!0,r=w(dt,e),o=e.startRow;o<=e.finishRow;o++)for(var u=e.startCol;u<=e.finishCol;u++)t=t&&ft.getAt(n,o,u).exists(r);return t?S.some(e):S.none()}(e,n)})},pt=function(t,n,e){return mt(t,n,e).map(function(n){var e=ft.filterItems(t,w(st,n));return B(e,function(n){return n.element})})},ht=function(n,e){return ft.findItem(n,e,function(n,e){return In(e,n)}).map(function(n){return n.element})},vt=function(i,c,a){return et(i).bind(function(n){var r,e,o,u,t=wt(n);return r=t,e=i,o=c,u=a,ft.findItem(r,e,Bn).bind(function(n){var e=0<o?n.row+n.rowspan-1:n.row,t=0<u?n.column+n.colspan-1:n.column;return ft.getAt(r,e+o,t+u).map(function(n){return n.element})})})},bt=function(n,e,t,r,o){var u=wt(n),i=Bn(n,t)?S.some(e):ht(u,e),c=Bn(n,o)?S.some(r):ht(u,r);return i.bind(function(e){return c.bind(function(n){return pt(u,e,n)})})},wt=ft.fromTable,yt=function(e,t){re(e).each(function(n){n.dom.insertBefore(t.dom,e.dom)})},Ct=function(n,e){ie(n).fold(function(){re(n).each(function(n){xt(n,e)})},function(n){yt(n,e)})},St=function(e,t){ae(e,0).fold(function(){xt(e,t)},function(n){e.dom.insertBefore(t.dom,n.dom)})},xt=function(n,e){n.dom.appendChild(e.dom)},Tt=function(n,e){yt(n,e),xt(e,n)},Rt=function(r,o){E(o,function(n,e){var t=0===e?r:o[e-1];Ct(t,n)})},Dt=function(e,n){E(n,function(n){xt(e,n)})},Ot=function(n){n.dom.textContent="",E(ce(n),function(n){At(n)})},At=function(n){var e=n.dom;null!==e.parentNode&&e.parentNode.removeChild(e)},Bt=function(n){var e,t=ce(n);0<t.length&&(e=n,E(t,function(n){yt(e,n)})),At(n)};var Et,It,Pt,kt=(Et=Qn,It="text",{get:function(n){if(!Et(n))throw new Error("Can only get "+It+" value of a "+It+" node");return Pt(n).getOr("")},getOption:Pt=function(n){return Et(n)?S.from(n.dom.nodeValue):S.none()},set:function(n,e){if(!Et(n))throw new Error("Can only set raw "+It+" value of a "+It+" node");n.dom.nodeValue=e}}),Mt=function(n){return kt.get(n)},Nt=function(n){return kt.getOption(n)},jt=function(n,e){return kt.set(n,e)},_t=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function zt(){return{up:b({selector:Te,closest:Oe,predicate:xe,all:oe}),down:b({selector:Ce,predicate:be}),styles:b({get:We,getRaw:Le,set:_e,remove:He}),attrs:b({get:Ie,set:Be,remove:ke,copyTo:function(n,e){var t=Me(n);Ee(e,t)}}),insert:b({before:yt,after:Ct,afterAll:Rt,append:xt,appendAll:Dt,prepend:St,wrap:Tt}),remove:b({unwrap:Bt,remove:At}),create:b({nu:Dn.fromTag,clone:function(n){return Dn.fromDom(n.dom.cloneNode(!1))},text:Dn.fromText}),query:b({comparePosition:function(n,e){return n.dom.compareDocumentPosition(e.dom)},prevSibling:ue,nextSibling:ie}),property:b({children:ce,name:Gn,parent:re,document:function(n){return te(n).dom},isText:Qn,isComment:Yn,isElement:Jn,getText:Mt,setText:jt,isBoundary:function(n){return!!Jn(n)&&("body"===Gn(n)||D(_t,Gn(n)))},isEmptyTag:function(n){return!!Jn(n)&&D(["br","img","hr","input"],Gn(n))},isNonEditable:function(n){return Jn(n)&&"false"===Ie(n,"contenteditable")}}),eq:Bn,is:Pn}}var Wt=function(r,o,n,e){var t=o(r,n);return P(e,function(n,e){var t=o(r,e);return Ft(r,n,t)},t)},Ft=function(e,n,t){return n.bind(function(n){return t.filter(w(e.eq,n))})},Lt=function(n,e,t){return 0<t.length?Wt(n,e,(r=t)[0],r.slice(1)):S.none();var r},Ht=function(t,n,e,r){void 0===r&&(r=f);var o=[n].concat(t.up().all(n)),u=[e].concat(t.up().all(e)),i=function(e){return N(e,r).fold(function(){return e},function(n){return e.slice(0,n+1)})},c=i(o),a=i(u),l=M(c,function(n){return O(a,(e=n,w(t.eq,e)));var e});return{firstpath:c,secondpath:a,shared:l}},qt=zt(),Vt=function(t,n){return Lt(qt,function(n,e){return t(e)},n)},Ut=function(n){return Te(n,"table")},$t=function(l,f,s){var d=function(e){return function(n){return s!==undefined&&s(n)||Bn(n,e)}};return Bn(l,f)?S.some({boxes:S.some([l]),start:l,finish:f}):Ut(l).bind(function(a){return Ut(f).bind(function(u){if(Bn(a,u))return S.some({boxes:(o=l,i=f,c=wt(a),pt(c,o,i)),start:l,finish:f});if(In(a,u)){var n=0<(e=we(f,"td,th",d(a))).length?e[e.length-1]:f;return S.some({boxes:bt(a,l,a,f,u),start:l,finish:n})}if(In(u,a)){var e,t=0<(e=we(l,"td,th",d(u))).length?e[e.length-1]:l;return S.some({boxes:bt(u,l,a,f,u),start:l,finish:t})}return Ht(qt,l,f,r).shared.bind(function(n){return Oe(n,"table",s).bind(function(n){var e=we(f,"td,th",d(n)),t=0<e.length?e[e.length-1]:f,r=we(l,"td,th",d(n)),o=0<r.length?r[r.length-1]:l;return S.some({boxes:bt(n,l,a,f,u),start:o,finish:t})})});var r,o,i,c})})},Gt=function(n,e){var t=Ce(n,e);return 0<t.length?S.some(t):S.none()},Kt=function(n,e,r){return De(n,e).bind(function(t){return De(n,r).bind(function(e){return Vt(Ut,[t,e]).map(function(n){return{first:t,last:e,table:n}})})})},Xt=function(n,e,t,r,o){return u=o,M(n,function(n){return On(n,u)}).bind(function(n){return vt(n,e,t).bind(function(n){return t=r,Te(e=n,"table").bind(function(n){return De(n,t).bind(function(n){return $t(n,e).bind(function(e){return e.boxes.map(function(n){return{boxes:n,start:e.start,finish:e.finish}})})})});var e,t})});var u},Yt=Gt,Jt=function(o,n,e){return Kt(o,n,e).bind(function(i){var n=function(n){return Bn(o,n)},e="thead,tfoot,tbody,table",t=Te(i.first,e,n),r=Te(i.last,e,n);return t.bind(function(u){return r.bind(function(n){return Bn(u,n)?(e=i.table,t=i.first,r=i.last,o=wt(e),gt(o,t,r)):S.none();var e,t,r,o})})})},Qt=function(i){if(!l(i))throw new Error("cases must be an array");if(0===i.length)throw new Error("there must be at least one case");var c=[],t={};return E(i,function(n,r){var e=kn(n);if(1!==e.length)throw new Error("one and only one name per case");var o=e[0],u=n[o];if(t[o]!==undefined)throw new Error("duplicate key detected:"+o);if("cata"===o)throw new Error("cannot have a case named cata (sorry)");if(!l(u))throw new Error("case arguments must be an array");c.push(o),t[o]=function(){var n=arguments.length;if(n!==u.length)throw new Error("Wrong number of arguments to case "+o+". Expected "+u.length+" ("+u+"), got "+n);for(var t=new Array(n),e=0;e<t.length;e++)t[e]=arguments[e];return{fold:function(){if(arguments.length!==i.length)throw new Error("Wrong number of arguments to fold. Expected "+i.length+", got "+arguments.length);return arguments[r].apply(null,t)},match:function(n){var e=kn(n);if(c.length!==e.length)throw new Error("Wrong number of arguments to match. Expected: "+c.join(",")+"\nActual: "+e.join(","));if(!z(c,function(n){return D(e,n)}))throw new Error("Not all branches were specified when using match. Specified: "+e.join(", ")+"\nRequired: "+c.join(", "));return n[o].apply(null,t)},log:function(n){console.log(n,{constructors:c,constructor:o,params:t})}}}}),t},Zt=Qt([{none:[]},{multiple:["elements"]},{single:["element"]}]),nr=function(n,e,t,r){return n.fold(e,t,r)},er=Zt.none,tr=Zt.multiple,rr=Zt.single,or=function(n,e,t){return{get:function(){return Yt(n(),t).fold(function(){return e().map(rr).getOrThunk(er)},function(n){return tr(n)})}}},ur=tinymce.util.Tools.resolve("tinymce.PluginManager"),ir=function(n,e,t,r){for(var o,u,i,c=e.grid.columns,a=e.grid.rows,l=0;l<a;l++)for(var f=!1,s=0;s<c;s++){l<t.minRow||l>t.maxRow||s<t.minCol||s>t.maxCol||(ft.getAt(e,l,s).filter(r).isNone()?(o=f,0,u=n[l].element,i=Dn.fromTag("td"),xt(i,Dn.fromTag("br")),(o?xt:St)(u,i)):f=!0)}},cr=function(n,e){var t,u,r,i,c,a,l,o,f,s,d=function(n){return On(n.element,e)},m=it(n),g=ft.generate(m),p=(u=d,r=(t=g).grid.columns,i=t.grid.rows,c=r,l=a=0,Nn(t.access,function(n){var e,t,r,o;u(n)&&(t=(e=n.row)+n.rowspan-1,o=(r=n.column)+n.colspan-1,e<i?i=e:a<t&&(a=t),r<c?c=r:l<o&&(l=o))}),{minRow:i,minCol:c,maxRow:a,maxCol:l}),h="th:not("+e+"),td:not("+e+")",v=Je(n,"th,td",function(n){return On(n,h)});return E(v,At),ir(m,g,p,d),f=p,s=I(Ye(o=n,"tr"),function(n){return 0===n.dom.childElementCount}),E(s,At),f.minCol!==f.maxCol&&f.minRow!==f.maxRow||E(Ye(o,"th,td"),function(n){ke(n,"rowspan"),ke(n,"colspan")}),ke(o,"width"),ke(o,"height"),He(o,"width"),He(o,"height"),n},ar=function(n){return"img"===Gn(n)?1:Nt(n).fold(function(){return ce(n).length},function(n){return n.length})},lr=["img","br"],fr=function(n){return Nt(n).filter(function(n){return 0!==n.trim().length||-1<n.indexOf("\xa0")}).isSome()||D(lr,Gn(n))},sr=function(n){return o=fr,(u=function(n){for(var e=0;e<n.childNodes.length;e++){var t=Dn.fromDom(n.childNodes[e]);if(o(t))return S.some(t);var r=u(n.childNodes[e]);if(r.isSome())return r}return S.none()})(n.dom);var o,u},dr=function(n){return mr(n,fr)},mr=function(n,u){var i=function(n){for(var e=ce(n),t=e.length-1;0<=t;t--){var r=e[t];if(u(r))return S.some(r);var o=i(r);if(o.isSome())return o}return S.none()};return i(n)},gr=function(n,e){return Dn.fromDom(n.dom.cloneNode(e))},pr=function(n){return gr(n,!1)},hr=function(n){return gr(n,!0)},vr=function(n,e){var t,r,o,u,i=(t=n,r=e,o=Dn.fromTag(r),u=Me(t),Ee(o,u),o),c=ce(hr(n));return Dt(i,c),i},br={scope:["row","col"]},wr=function(){var n=Dn.fromTag("td");return xt(n,Dn.fromTag("br")),n},yr=function(){return Dn.fromTag("col")},Cr=function(){return Dn.fromTag("colgroup")},Sr=function(n,e,t){var r=vr(n,e);return Nn(t,function(n,e){null===n?ke(r,e):Be(r,e,n)}),r},xr=function(n){return n},Tr=function(n){return function(){return Dn.fromTag("tr",n.dom)}},Rr=function(f,n,s){var d=function(n,e){var t,r,o,u;t=n.element,r=e,o=t.dom,u=r.dom,Ne(o)&&Ne(u)&&(u.style.cssText=o.style.cssText),He(e,"height"),1!==n.colspan&&He(n.element,"width")};return{col:function(n){var e=ee(n.element),t=Dn.fromTag(Gn(n.element),e.dom);return d(n,t),f(n.element,t),t},colgroup:Cr,row:Tr(n),cell:function(n){var r,o,u,i,c,e=ee(n.element),t=Dn.fromTag(Gn(n.element),e.dom),a=s.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),l=0<a.length?(r=n.element,o=t,u=a,sr(r).map(function(n){var e=u.join(","),t=we(n,e,function(n){return Bn(n,r)});return P(t,function(n,e){var t=pr(e);return ke(t,"contenteditable"),xt(n,t),t},o)}).getOr(o)):t;return xt(l,Dn.fromTag("br")),d(n,t),i=n.element,c=t,Nn(br,function(e,t){return Pe(i,t).filter(function(n){return D(e,n)}).each(function(n){return Be(c,t,n)})}),f(n.element,t),t},replace:Sr,gap:wr}},Dr=function(n){return{col:yr,colgroup:Cr,row:Tr(n),cell:wr,replace:xr,gap:wr}},Or=function(n){return B(n,Dn.fromDom)},Ar=function(n){return nr(n.get(),b([]),u,W)},Br="data-mce-selected",Er="data-mce-first-selected",Ir="data-mce-last-selected",Pr={selected:Br,selectedSelector:"td[data-mce-selected],th[data-mce-selected]",firstSelected:Er,firstSelectedSelector:"td[data-mce-first-selected],th[data-mce-first-selected]",lastSelected:Ir,lastSelectedSelector:"td[data-mce-last-selected],th[data-mce-last-selected]"},kr=function(n){return{element:n,mergable:S.none(),unmergable:S.none(),selection:[n]}},Mr=function(n,e,t){return{element:t,mergable:(u=e,i=Pr,nr(n.get(),S.none,function(e){return e.length<=1?S.none():Jt(u,i.firstSelectedSelector,i.lastSelectedSelector).map(function(n){return{bounds:n,cells:e}})},S.none)),unmergable:(r=function(n,e){return Pe(n,e).exists(function(n){return 1<parseInt(n,10)})},0<(o=Ar(n)).length&&z(o,function(n){return r(n,"rowspan")||r(n,"colspan")})?S.some(o):S.none()),selection:Ar(n)};var r,o,u,i},Nr=function(s,n,d,m){s.on("BeforeGetContent",function(t){!0===t.selection&&nr(n.get(),y,function(n){t.preventDefault(),et(n[0]).map(hr).map(function(n){return[cr(n,"[data-mce-selected]")]}).each(function(n){var e;t.content="text"===t.format?B(n,function(n){return n.dom.innerText}).join(""):(e=s,B(n,function(n){return e.selection.serializer.serialize(n.dom,{})}).join(""))})},y)}),s.on("BeforeSetContent",function(f){!0===f.selection&&!0===f.paste&&S.from(s.dom.getParent(s.selection.getStart(),"th,td")).each(function(n){var l=Dn.fromDom(n);et(l).each(function(e){var n,t,r,o,u,i,c,a=I((n=f.content,(r=(t||document).createElement("div")).innerHTML=n,ce(Dn.fromDom(r))),function(n){return"meta"!==Gn(n)});1===a.length&&(c=a[0],"table"===Gn(c))&&(f.preventDefault(),o=Dn.fromDom(s.getDoc()),u=Dr(o),i={element:l,clipboard:a[0],generators:u},d.pasteCells(e,i).each(function(n){s.selection.setRng(n),s.focus(),m.clear(e)}))})})})},jr=Qt([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),_r=H({},jr),zr=function(n,e,r,o,u){var t,i,c=n.slice(0),a=(i=e,0===(t=n).length?_r.none():1===t.length?_r.only(0):0===i?_r.left(0,1):i===t.length-1?_r.right(i-1,i):0<i&&i<t.length-1?_r.middle(i-1,i,i+1):_r.none()),l=b(B(c,b(0)));return a.fold(l,function(n){return o.singleColumnWidth(c[n],r)},function(n,e){return u.calcLeftEdgeDeltas(c,n,e,r,o.minCellWidth(),o.isRelative)},function(n,e,t){return u.calcMiddleDeltas(c,n,e,t,r,o.minCellWidth(),o.isRelative)},function(n,e){return u.calcRightEdgeDeltas(c,n,e,r,o.minCellWidth(),o.isRelative)})},Wr=function(t){var n=t.grid,e=A(n.columns,u),r=A(n.rows,u);return B(e,function(e){return Fr(function(){return _(r,function(n){return ft.getAt(t,n,e).filter(function(n){return n.column===e}).toArray()})},function(n){return 1===n.colspan},function(){return ft.getAt(t,0,e)})})},Fr=function(n,e,t){var r=n();return M(r,e).orThunk(function(){return S.from(r[0]).orThunk(t)}).map(function(n){return n.element})},Lr=function(t){var n=t.grid,e=A(n.rows,u),r=A(n.columns,u);return B(e,function(e){return Fr(function(){return _(r,function(n){return ft.getAt(t,e,n).filter(function(n){return n.row===e}).fold(b([]),function(n){return[n]})})},function(n){return 1===n.rowspan},function(){return ft.getAt(t,e,0)})})},Hr=function(r,o){if(o<0||o>=r.length-1)return S.none();var n=r[o].fold(function(){var n,e,t=(n=r.slice(0,o),(e=x.call(n,0)).reverse(),e);return L(t,function(n,e){return n.map(function(n){return{value:n,delta:e+1}})})},function(n){return S.some({value:n,delta:0})}),e=r[o+1].fold(function(){var n=r.slice(o+1);return L(n,function(n,e){return n.map(function(n){return{value:n,delta:e+1}})})},function(n){return S.some({value:n,delta:1})});return n.bind(function(t){return e.map(function(n){var e=n.delta+t.delta;return Math.abs(n.value-t.value)/e})})},qr=function(e,t){return function(n){return"rtl"===Vr(n)?t:e}},Vr=function(n){return"rtl"===We(n,"direction")?"rtl":"ltr"};function Ur(r,o){var n=function(n){var e=o(n);if(e<=0||null===e){var t=We(n,r);return parseFloat(t)||0}return e},u=function(o,n){return k(n,function(n,e){var t=We(o,e),r=t===undefined?0:parseInt(t,10);return isNaN(r)?n:n+r},0)};return{set:function(n,e){if(!v(e)&&!e.match(/^[0-9]+$/))throw new Error(r+".set accepts only positive integer values. Value was "+e);var t=n.dom;Ne(t)&&(t.style[r]=e+"px")},get:n,getOuter:n,aggregate:u,max:function(n,e,t){var r=u(n,t);return r<e?e-r:0}}}var $r,Gr,Kr,Xr,Yr=Ur("height",function(n){var e=n.dom;return he(n)?e.getBoundingClientRect().height:e.offsetHeight}),Jr=function(n){return Yr.get(n)},Qr=function(n){return Yr.getOuter(n)},Zr=function(t,r){return{left:t,top:r,translate:function(n,e){return Zr(t+n,r+e)}}},no=Zr,eo=function(n,e){return n!==undefined?n:e!==undefined?e:0},to=function(n){var e=n.dom.ownerDocument,t=e.body,r=e.defaultView,o=e.documentElement;if(t===n.dom)return no(t.offsetLeft,t.offsetTop);var u=eo(null==r?void 0:r.pageYOffset,o.scrollTop),i=eo(null==r?void 0:r.pageXOffset,o.scrollLeft),c=eo(o.clientTop,t.clientTop),a=eo(o.clientLeft,t.clientLeft);return ro(n).translate(i-a,u-c)},ro=function(n){var e,t=n.dom,r=t.ownerDocument.body;return r===t?no(r.offsetLeft,r.offsetTop):he(n)?(e=t.getBoundingClientRect(),no(e.left,e.top)):no(0,0)},oo=Ur("width",function(n){return n.dom.offsetWidth}),uo=function(n){return oo.get(n)},io=function(n){return oo.getOuter(n)},co=function(n,e){return{row:n,y:e}},ao=function(n,e){return{col:n,x:e}},lo=function(n){return to(n).left+io(n)},fo=function(n){return to(n).left},so=function(n,e){return ao(n,fo(e))},mo=function(n,e){return ao(n,lo(e))},go=function(n){return to(n).top},po=function(n,e){return co(n,go(e))},ho=function(n,e){return co(n,go(e)+Qr(e))},vo=function(t,e,r){if(0===r.length)return[];var n=B(r.slice(1),function(n,e){return n.map(function(n){return t(e,n)})}),o=r[r.length-1].map(function(n){return e(r.length-1,n)});return n.concat([o])},bo={delta:u,positions:function(n){return vo(po,ho,n)},edge:go},wo=qr({delta:u,edge:fo,positions:function(n){return vo(so,mo,n)}},{delta:function(n){return-n},edge:lo,positions:function(n){return vo(mo,so,n)}}),yo={delta:function(n,e){return wo(e).delta(n,e)},positions:function(n,e){return wo(e).positions(n,e)},edge:function(n){return wo(n).edge(n)}},Co={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},So=(Gr="[eE][+-]?[0-9]+",Xr=["Infinity",($r="[0-9]+")+"\\."+(Kr=function(n){return"(?:"+n+")?"})($r)+Kr(Gr),"\\."+$r+Kr(Gr),$r+Kr(Gr)].join("|"),new RegExp("^([+-]?(?:"+Xr+"))(.*)$")),xo=function(n,o){return S.from(So.exec(n)).bind(function(n){var e,t=Number(n[1]),r=n[2];return e=r,O(o,function(n){return O(Co[n],function(n){return e===n})})?S.some({value:t,unit:r}):S.none()})},To=function(){var n=Tn().browser;return n.isIE()||n.isEdge()},Ro=function(n,e,t){return r=We(n,e),o=t,u=parseFloat(r),isNaN(u)?o:u;var r,o,u},Do=function(n){return To()?(t=(e=n).dom.getBoundingClientRect().height,"border-box"===We(e,"box-sizing")?t:t-Ro(e,"padding-top",0)-Ro(e,"padding-bottom",0)-(Ro(e,"border-top-width",0)+Ro(e,"border-bottom-width",0))):Ro(n,"height",Jr(n));var e,t},Oo=function(n){return To()?(t=(e=n).dom.getBoundingClientRect().width,"border-box"===We(e,"box-sizing")?t:t-Ro(e,"padding-left",0)-Ro(e,"padding-right",0)-(Ro(e,"border-left-width",0)+Ro(e,"border-right-width",0))):Ro(n,"width",uo(n));var e,t},Ao=/(\d+(\.\d+)?)%/,Bo=/(\d+(\.\d+)?)px|em/,Eo=function(n,e){var t,r=(t=n,S.from(t.dom.offsetParent).map(Dn.fromDom).getOr(ve(ee(n))));return e(n)/e(r)*100},Io=function(n,e){_e(n,"width",e+"px")},Po=function(n,e){_e(n,"width",e+"%")},ko=function(n,e){_e(n,"height",e+"px")},Mo=function(n,e,t,r){var o,u,i,c,a,l=parseInt(n,10);return tn(n,"%")&&"table"!==Gn(e)?(u=l,i=t,c=r,a=et(o=e).map(function(n){var e=i(n);return Math.floor(u/100*e)}).getOr(u),c(o,a),a):l},No=function(n){var e,t=Le(e=n,"height").getOrThunk(function(){return Do(e)+"px"});return t?Mo(t,n,Jr,ko):Jr(n)},jo=function(n){return Le(n,"width").fold(function(){return S.from(Ie(n,"width"))},function(n){return S.some(n)})},_o=function(n,e){return n/e.pixelWidth()*100},zo=function(e,t){return jo(e).fold(function(){var n=uo(e);return _o(n,t)},function(n){return function(n,e,t){var r=Ao.exec(e);if(null!==r)return parseFloat(r[1]);var o=Oo(n);return _o(o,t)}(e,n,t)})},Wo=function(e,t){return jo(e).fold(function(){return Oo(e)},function(n){return function(n,e,t){var r=Bo.exec(e);if(null!==r)return parseInt(r[1],10);var o=Ao.exec(e);if(null===o)return Oo(n);var u=parseFloat(o[1]);return u/100*t.pixelWidth()}(e,n,t)})},Fo=function(n){return t="rowspan",No(e=n)/Ve(e,t);var e,t},Lo=function(n,e,t){_e(n,"width",e+t)},Ho=function(n){return Eo(n,uo)+"%"},qo=b(Ao),Vo=b(Bo),Uo=function(n,e,t){return Le(n,e).fold(function(){return t(n)+"px"},function(n){return n})},$o=function(n,e){return Uo(n,"width",function(n){return Wo(n,e)})},Go=function(n){return Uo(n,"height",Fo)},Ko=function(n,t,r,o){var e,u=ft.hasColumns(n)?(e=n,B(ft.justColumns(e),function(n){return S.from(n.element)})):Wr(n),i=B(u,function(n){return n.map(yo.edge)});return B(u,function(n,e){return n.filter(d(Ue)).fold(function(){var n=Hr(i,e);return r(n)},function(n){return t(n,o)})})},Xo=function(n){return n.map(function(n){return n+"px"}).getOr("")},Yo=function(n,e){return Ko(n,zo,function(n){return n.fold(function(){return e.minCellWidth()},function(n){return n/e.pixelWidth()*100})},e)},Jo=function(n,e){return Ko(n,Wo,function(n){return n.getOrThunk(e.minCellWidth)},e)},Qo=function(n,e,t,r){var o=Lr(n),u=B(o,function(n){return n.map(e.edge)});return B(o,function(n,e){return n.filter(d($e)).fold(function(){var n=Hr(u,e);return r(n)},function(n){return t(n)})})},Zo=function(n,e,t){for(var r=0,o=n;o<e;o++)r+=t[o]!==undefined?t[o]:0;return r},nu=function(n,e){return ft.hasColumns(n)?(u=n,i=e,c=ft.justColumns(u),B(c,function(n,e){return{element:n.element,width:i[e],colspan:n.colspan}})):(t=n,r=e,o=ft.justCells(t),B(o,function(n){var e=Zo(n.column,n.column+n.colspan,r);return{element:n.element,width:e,colspan:n.colspan}}));var t,r,o,u,i,c},eu=function(n,e,t){var r=nu(n,e);E(r,function(n){t.setElementWidth(n.element,n.width)})},tu=function(n,e,t,r,o){var u=ft.fromTable(n),i=o.getCellDelta(e),c=o.getWidths(u,o),a=t===u.grid.columns-1,l=r.clampTableDelta(c,t,i,o.minCellWidth(),a),f=zr(c,t,l,o,r),s=B(f,function(n,e){return n+c[e]});eu(u,s,o),r.resizeTable(o.adjustTableWidth,l,a)},ru=function(n,t,r,e){var o,u,i,c,a=ft.fromTable(n),l=Qo(a,e,Fo,function(n){return n.getOrThunk(Xe)}),f=B(l,function(n,e){return r===e?Math.max(t+n,Xe()):n}),s=(o=a,u=f,i=ft.justCells(o),B(i,function(n){var e=Zo(n.row,n.row+n.rowspan,u);return{element:n.element,height:e,rowspan:n.rowspan}})),d=(c=f,B(a.all,function(n,e){return{element:n.element,height:c[e]}}));E(d,function(n){ko(n.element,n.height)}),E(s,function(n){ko(n.element,n.height)});var m=P(f,function(n,e){return n+e},0);ko(n,m)},ou=function(n){return B(n,b(0))},uu=function(n,e,t,r,o){return o(n.slice(0,e)).concat(r).concat(o(n.slice(t)))},iu=function(i){return function(n,e,t,r){if(i(t)){var o=Math.max(r,n[e]-Math.abs(t)),u=Math.abs(o-n[e]);return 0<=t?u:-u}return t}},cu=iu(function(n){return n<0}),au=iu(C),lu=function(){var f=function(n,t,e,r){var o=(100+e)/100,u=Math.max(r,(n[t]+e)/o);return B(n,function(n,e){return(e===t?u:n/o)-n})},c=function(n,e,t,r,o,u){return u?f(n,e,r,o):(a=t,l=cu(i=n,c=e,r,o),uu(i,c,a+1,[l,0],ou));var i,c,a,l};return{resizeTable:function(n,e){return n(e)},clampTableDelta:cu,calcLeftEdgeDeltas:c,calcMiddleDeltas:function(n,e,t,r,o,u,i){return c(n,t,r,o,u,i)},calcRightEdgeDeltas:function(n,e,t,r,o,u){if(u)return f(n,t,r,o);var i=cu(n,t,r,o);return ou(n.slice(0,t)).concat([i])}}},fu=function(n,e){var t=S.from(n.dom.documentElement).map(Dn.fromDom).getOr(n);return{parent:b(t),view:b(n),origin:b(no(0,0)),isResizable:e}},su=function(n,e,t){return{parent:b(e),view:b(n),origin:b(no(0,0)),isResizable:t}},du=Qt([{invalid:["raw"]},{pixels:["value"]},{percent:["value"]}]),mu=function(n,e,t){var r=t.substring(0,t.length-n.length),o=parseFloat(r);return r===o.toString()?e(o):du.invalid(t)},gu=H(H({},du),{from:function(n){return tn(n,"%")?mu("%",du.percent,n):tn(n,"px")?mu("px",du.pixels,n):du.invalid(n)}}),pu=function(n,r,o){return n.fold(function(){return r},function(n){return t=(e=n)/o,B(r,function(n){return gu.from(n).fold(function(){return n},function(n){return n*t+"px"},function(n){return n/100*e+"px"})});var e,t},function(n){return e=o,B(r,function(n){return gu.from(n).fold(function(){return n},function(n){return n/e*100+"%"},function(n){return n+"%"})});var e})},hu=function(n,e,t){var r,o,u,i=gu.from(t),c=z(n,function(n){return"0px"===n})?(r=i,o=n.length,u=r.fold(function(){return b("")},function(n){return b(n/o+"px")},function(){return b(100/o+"%")}),A(o,u)):pu(i,n,e);return bu(c)},vu=function(n,e){return 0===n.length?e:P(n,function(n,e){return gu.from(e).fold(b(0),u,u)+n},0)},bu=function(n){if(0===n.length)return n;var e,t,r=P(n,function(n,e){var t=gu.from(e).fold(function(){return{value:e,remainder:0}},function(n){return e=n,t="px",{value:(r=Math.floor(e))+t,remainder:e-r};var e,t,r},function(n){return{value:n+"%",remainder:0}});return{output:[t.value].concat(n.output),remainder:n.remainder+t.remainder}},{output:[],remainder:0}),o=r.output;return o.slice(0,o.length-1).concat([(e=o[o.length-1],t=Math.round(r.remainder),gu.from(e).fold(b(e),function(n){return n+t+"px"},function(n){return n+t+"%"}))])},wu=gu.from,yu=function(n){return wu(n).fold(b("px"),b("px"),b("%"))},Cu=function(l,n,e,f){var s=ft.fromTable(l),a=s.all,d=ft.justCells(s),m=ft.justColumns(s);n.each(function(n){var r,o,u,i,e=yu(n),t=uo(l),c=Ko(s,$o,Xo,f),a=hu(c,t,n);ft.hasColumns(s)?(u=a,i=e,E(m,function(n,e){var t=vu([u[e]],Ke());_e(n.element,"width",t+i)})):(r=a,o=e,E(d,function(n){var e=r.slice(n.column,n.colspan+n.column),t=vu(e,Ke());_e(n.element,"width",t+o)})),_e(l,"width",n)}),e.each(function(n){var r,e,o,t=yu(n),u=Jr(l),i=Qo(s,bo,Go,Xo),c=hu(i,u,n);r=c,e=a,o=t,E(d,function(n){var e=r.slice(n.row,n.rowspan+n.row),t=vu(e,Xe());_e(n.element,"height",t+o)}),E(e,function(n,e){_e(n.element,"height",r[e])}),_e(l,"height",n)})},Su=function(n){return jo(n).exists(function(n){return Ao.test(n)})},xu=function(n){return jo(n).exists(function(n){return Bo.test(n)})},Tu=function(n){return jo(n).isNone()},Ru=Ho,Du=function(n){return ft.fromTable(n).grid},Ou=function(e){var o=[];return{bind:function(n){if(n===undefined)throw new Error("Event bind error: undefined handler");o.push(n)},unbind:function(e){o=I(o,function(n){return n!==e})},trigger:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r={};E(e,function(n,e){r[n]=t[e]}),E(o,function(n){n(r)})}}},Au=function(n){return{registry:jn(n,function(n){return{bind:n.bind,unbind:n.unbind}}),trigger:jn(n,function(n){return n.trigger})}},Bu=function(n){return n.slice(0).sort()},Eu=function(r,o,u){if(0===o.length)throw new Error("You must specify at least one required field.");var t;return function(e,n){if(!l(n))throw new Error("The "+e+" fields must be an array. Was: "+n+".");E(n,function(n){if(!p(n))throw new Error("The value "+n+" in the "+e+" fields was not a string.")})}("required",o),t=Bu(o),M(t,function(n,e){return e<t.length-1&&n===t[e+1]}).each(function(n){throw new Error("The field: "+n+" occurs more than once in the combined fields: ["+t.join(", ")+"].")}),function(e){var t=kn(e);z(o,function(n){return D(t,n)})||function(n,e){throw new Error("All required keys ("+Bu(n).join(", ")+") were not specified. Specified keys were: "+Bu(e).join(", ")+".")}(o,t),r(o,t);var n=I(o,function(n){return!u.validate(e[n],n)});return 0<n.length&&function(n,e){throw new Error("All values need to be of type: "+e+". Keys ("+Bu(n).join(", ")+") were not.")}(n,u.label),e}},Iu=function(e,n){var t=I(n,function(n){return!D(e,n)});0<t.length&&function(n){throw new Error("Unsupported keys for object: "+Bu(n).join(", "))}(t)},Pu=function(n){return Eu(Iu,n,{validate:h,label:"function"})},ku=Pu(["compare","extract","mutate","sink"]),Mu=Pu(["element","start","stop","destroy"]),Nu=Pu(["forceDrop","drop","move","delayDrop"]);function ju(){var u=S.none(),i=Au({move:Ou(["info"])});return{onEvent:function(n,o){o.extract(n).each(function(n){var e,t,r;(e=o,t=n,r=u.map(function(n){return e.compare(n,t)}),u=S.some(t),r).each(function(n){i.trigger.move(n)})})},reset:function(){u=S.none()},events:i.registry}}function _u(){var n={onEvent:y,reset:y},e=ju(),t=n;return{on:function(){t.reset(),t=e},off:function(){t.reset(),t=n},isOn:function(){return t===e},onEvent:function(n,e){t.onEvent(n,e)},events:e.events}}var zu=function(e,t,n){var r,o,u,i=!1,c=Au({start:Ou([]),stop:Ou([])}),a=_u(),l=function(){d.stop(),a.isOn()&&(a.off(),c.trigger.stop())},f=(r=l,o=200,u=null,{cancel:function(){null!==u&&(clearTimeout(u),u=null)},throttle:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];null!==u&&clearTimeout(u),u=setTimeout(function(){r.apply(null,n),u=null},o)}});a.events.move.bind(function(n){t.mutate(e,n.info)});var s=function(t){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];i&&t.apply(null,n)}},d=t.sink(Nu({forceDrop:l,drop:s(l),move:s(function(n){f.cancel(),a.onEvent(n,t)}),delayDrop:s(f.throttle)}),n);return{element:d.element,go:function(n){d.start(n),a.on(),c.trigger.start()},on:function(){i=!0},off:function(){i=!1},destroy:function(){d.destroy()},events:c.registry}},Wu=function(n){var t,r,e=Dn.fromDom(ge(n).getOr(n.target)),o=function(){return n.stopPropagation()},u=function(){return n.preventDefault()},i=(t=u,r=o,function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t(r.apply(null,n))});return{target:e,x:n.clientX,y:n.clientY,stop:o,prevent:u,kill:i,raw:n}},Fu=function(n,e,t,r,o){var u,i,c=(u=t,i=r,function(n){u(n)&&i(Wu(n))});return n.dom.addEventListener(e,c,o),{unbind:w(Lu,n,e,c,o)}},Lu=function(n,e,t,r){n.dom.removeEventListener(e,t,r)},Hu=C,qu=function(n,e,t){return Fu(n,e,Hu,t,!1)},Vu=Wu,Uu=function(n,e){var t=Ie(n,e);return t===undefined||""===t?[]:t.split(" ")},$u=function(n){return n.dom.classList!==undefined},Gu=function(n,e){return o=e,u=Uu(t=n,r="class").concat([o]),Be(t,r,u.join(" ")),!0;var t,r,o,u},Ku=function(n,e){return o=e,0<(u=I(Uu(t=n,r="class"),function(n){return n!==o})).length?Be(t,r,u.join(" ")):ke(t,r),!1;var t,r,o,u},Xu=function(n,e){$u(n)?n.dom.classList.add(e):Gu(n,e)},Yu=function(n){0===($u(n)?n.dom.classList:Uu(n,"class")).length&&ke(n,"class")},Ju=function(n,e){return $u(n)&&n.dom.classList.contains(e)},Qu=function(n){var e=n.replace(/\./g,"-");return{resolve:function(n){return e+"-"+n}}},Zu=Qu("ephox-dragster").resolve,ni=ku({compare:function(n,e){return no(e.left-n.left,e.top-n.top)},extract:function(n){return S.some(no(n.x,n.y))},sink:function(n,e){var t=function(n){var e=H({layerClass:Zu("blocker")},n),t=Dn.fromTag("div");Be(t,"role","presentation"),ze(t,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),Xu(t,Zu("blocker")),Xu(t,e.layerClass);return{element:function(){return t},destroy:function(){At(t)}}}(e),r=qu(t.element(),"mousedown",n.forceDrop),o=qu(t.element(),"mouseup",n.drop),u=qu(t.element(),"mousemove",n.move),i=qu(t.element(),"mouseout",n.delayDrop);return Mu({element:t.element,start:function(n){xt(n,t.element())},stop:function(){At(t.element())},destroy:function(){t.destroy(),o.unbind(),u.unbind(),i.unbind(),r.unbind()}})},mutate:function(n,e){n.mutate(e.left,e.top)}}),ei=function(n){return"true"===Ie(n,"contenteditable")},ti=Qu("ephox-snooker").resolve,ri=function(){var t,r=Au({drag:Ou(["xDelta","yDelta","target"])}),o=S.none(),n={mutate:function(n,e){t.trigger.drag(n,e)},events:(t=Au({drag:Ou(["xDelta","yDelta"])})).registry};n.events.drag.bind(function(e){o.each(function(n){r.trigger.drag(e.xDelta,e.yDelta,n)})});return{assign:function(n){o=S.some(n)},get:function(){return o},mutate:n.mutate,events:r.registry}},oi=ti("resizer-bar"),ui=ti("resizer-rows"),ii=ti("resizer-cols"),ci=function(n){var e=Ce(n.parent(),"."+oi);E(e,At)},ai=function(t,n,r){var o=t.origin();E(n,function(n){n.each(function(n){var e=r(o,n);Xu(e,oi),xt(t.parent(),e)})})},li=function(n,e,l,f){ai(n,e,function(n,e){var t,r,o,u,i,c,a=(t=e.col,r=e.x-n.left,o=l.top-n.top,u=7,i=f,c=Dn.fromTag("div"),ze(c,{position:"absolute",left:r-u/2+"px",top:o+"px",height:i+"px",width:u+"px"}),Ee(c,{"data-column":t,role:"presentation"}),c);return Xu(a,ii),a})},fi=function(n,e,l,f){ai(n,e,function(n,e){var t,r,o,u,i,c,a=(t=e.row,r=l.left-n.left,o=e.y-n.top,u=f,i=7,c=Dn.fromTag("div"),ze(c,{position:"absolute",left:r+"px",top:o-i/2+"px",height:i+"px",width:u+"px"}),Ee(c,{"data-row":t,role:"presentation"}),c);return Xu(a,ui),a})},si=function(n,e,t,r,o){var u,i=to(t),c=e.isResizable,a=0<r.length?bo.positions(r,t):[],l=0<a.length?(u=c,_(n.all,function(n,e){return u(n.element)?[e]:[]})):[],f=I(a,function(n,e){return O(l,function(n){return e===n})});fi(e,f,i,io(t));var s,d,m,g=0<o.length?yo.positions(o,t):[],p=0<g.length?(d=c,m=[],A((s=n).grid.columns,function(n){ft.getColumnAt(s,n).map(function(n){return n.element}).forall(d)&&m.push(n)}),I(m,function(e){var n=ft.filterItems(s,function(n){return n.column===e});return z(n,function(n){return d(n.element)})})):[],h=I(g,function(n,e){return O(p,function(n){return e===n})});li(e,h,i,Qr(t))},di=function(n,e){var t,r,o;ci(n),n.isResizable(e)&&(t=ft.fromTable(e),r=Lr(t),o=Wr(t),si(t,n,e,r,o))},mi=function(n,e){var t=Ce(n.parent(),"."+oi);E(t,e)},gi=function(n){mi(n,function(n){_e(n,"display","none")})},pi=function(n){mi(n,function(n){_e(n,"display","block")})},hi=ti("resizer-bar-dragging"),vi=function(o){var t=ri(),r=function(n,e){void 0===e&&(e={});var t=e.mode!==undefined?e.mode:ni;return zu(n,t,e)}(t,{}),e=S.none(),n=function(n,e){return S.from(Ie(n,e))};t.events.drag.bind(function(t){n(t.target,"data-row").each(function(n){var e=Ge(t.target,"top");_e(t.target,"top",e+t.yDelta+"px")}),n(t.target,"data-column").each(function(n){var e=Ge(t.target,"left");_e(t.target,"left",e+t.xDelta+"px")})});var u=function(n,e){return Ge(n,e)-qe(n,"data-initial-"+e,0)};r.events.stop.bind(function(){t.get().each(function(r){e.each(function(t){n(r,"data-row").each(function(n){var e=u(r,"top");ke(r,"data-initial-top"),s.trigger.adjustHeight(t,e,parseInt(n,10))}),n(r,"data-column").each(function(n){var e=u(r,"left");ke(r,"data-initial-left"),s.trigger.adjustWidth(t,e,parseInt(n,10))}),di(o,t)})})});var i=function(n,e){s.trigger.startAdjust(),t.assign(n),Be(n,"data-initial-"+e,Ge(n,e)),Xu(n,hi),_e(n,"opacity","0.2"),r.go(o.parent())},c=qu(o.parent(),"mousedown",function(n){var e,t;e=n.target,Ju(e,ui)&&i(n.target,"top"),t=n.target,Ju(t,ii)&&i(n.target,"left")}),a=function(n){return Bn(n,o.view())},l=function(n){return Oe(n,"table",a).filter(function(n){return Oe(n,"[contenteditable]",a).exists(ei)})},f=qu(o.view(),"mouseover",function(n){l(n.target).fold(function(){he(n.target)&&ci(o)},function(n){e=S.some(n),di(o,n)})}),s=Au({adjustHeight:Ou(["table","delta","row"]),adjustWidth:Ou(["table","delta","column"]),startAdjust:Ou([])});return{destroy:function(){c.unbind(),f.unbind(),r.destroy(),ci(o)},refresh:function(n){di(o,n)},on:r.on,off:r.off,hideBars:w(gi,o),showBars:w(pi,o),events:s.registry}},bi=function(n,o,u){var r=bo,i=yo,e=vi(n),c=Au({beforeResize:Ou(["table","type"]),afterResize:Ou(["table","type"]),startDrag:Ou([])});return e.events.adjustHeight.bind(function(n){var e=n.table;c.trigger.beforeResize(e,"row");var t=r.delta(n.delta,e);ru(e,t,n.row,r),c.trigger.afterResize(e,"row")}),e.events.startAdjust.bind(function(n){c.trigger.startDrag()}),e.events.adjustWidth.bind(function(n){var e=n.table;c.trigger.beforeResize(e,"col");var t=i.delta(n.delta,e),r=u(e);tu(e,t,n.column,o,r),c.trigger.afterResize(e,"col")}),{on:e.on,off:e.off,hideBars:e.hideBars,showBars:e.showBars,destroy:e.destroy,events:c.registry}},wi=function(n,e){return n.fire("newrow",{node:e})},yi=function(n,e){return n.fire("newcell",{node:e})},Ci=function(n,e,t,r,o){n.fire("TableSelectionChange",{cells:e,start:t,finish:r,otherCells:o})},Si=function(n){n.fire("TableSelectionClear")},xi=function(n,e,t){n.fire("TableModified",H(H({},t),{table:e}))},Ti={"border-collapse":"collapse",width:"100%"},Ri={border:"1"},Di="preservetable",Oi=function(n){return n.getParam("table_sizing_mode","auto")},Ai=function(n){return n.getParam("table_responsive_width")},Bi=function(n){return n.getParam("table_default_attributes",Ri,"object")},Ei=function(n){return n.getParam("table_default_styles",function(n){if(_i(n)){var e=n.getBody().offsetWidth;return H(H({},Ti),{width:e+"px"})}return zi(n)?zn(Ti,function(n,e){return"width"!==e}):Ti}(n),"object")},Ii=function(n){return n.getParam("table_tab_navigation",!0,"boolean")},Pi=function(n){return n.getParam("table_cell_advtab",!0,"boolean")},ki=function(n){return n.getParam("table_row_advtab",!0,"boolean")},Mi=function(n){return n.getParam("table_advtab",!0,"boolean")},Ni=function(n){return n.getParam("table_style_by_css",!1,"boolean")},ji=function(n){return"relative"===Oi(n)||!0===Ai(n)},_i=function(n){return"fixed"===Oi(n)||!1===Ai(n)},zi=function(n){return"responsive"===Oi(n)},Wi=function(n){var e="section",t=n.getParam("table_header_type",e,"string");return D(["section","cells","sectionCells","auto"],t)?t:e},Fi=function(n){var e=n.getParam("table_column_resizing",Di,"string");return M(["preservetable","resizetable"],function(n){return n===e}).getOr(Di)},Li=function(n){return"preservetable"===Fi(n)},Hi=function(n){var e=n.getParam("table_clone_elements");return p(e)?S.some(e.split(/[ ,]/)):Array.isArray(e)?S.some(e):S.none()},qi=function(n){return n.nodeName.toLowerCase()},Vi=function(n){return Dn.fromDom(n.getBody())},Ui=function(n){return n.getBoundingClientRect().width},$i=function(n){return n.getBoundingClientRect().height},Gi=function(e){return function(n){return Bn(n,Vi(e))}},Ki=function(n){return/^\d+(\.\d+)?$/.test(n)?n+"px":n},Xi=function(n){ke(n,"data-mce-style");var e=function(n){return ke(n,"data-mce-style")};E(Ze(n),e),E(nt(n),e)},Yi=function(n,e){var t=n.dom.getStyle(e,"width")||n.dom.getAttrib(e,"width");return S.from(t).filter(on)},Ji=function(n){return/^(\d+(\.\d+)?)%$/.test(n)},Qi=function(n){return Dn.fromDom(n.selection.getStart())},Zi=function(n){var e=n;return{get:function(){return e},set:function(n){e=n}}},nc=function(n){var e=function(){return uo(n)},t=b(0);return{width:e,pixelWidth:e,getWidths:Jo,getCellDelta:t,singleColumnWidth:b([0]),minCellWidth:t,setElementWidth:y,adjustTableWidth:y,isRelative:!0,label:"none"}},ec=function(n,r){var o=Zi(parseFloat(n)),u=Zi(uo(r));return{width:o.get,pixelWidth:u.get,getWidths:Yo,getCellDelta:function(n){return n/u.get()*100},singleColumnWidth:function(n,e){return[100-n]},minCellWidth:function(){return Ke()/u.get()*100},setElementWidth:Po,adjustTableWidth:function(n){var e=o.get(),t=e+n/100*e;Po(r,t),o.set(t),u.set(uo(r))},isRelative:!0,label:"percent"}},tc=function(n,t){var r=Zi(n),o=r.get;return{width:o,pixelWidth:o,getWidths:Jo,getCellDelta:u,singleColumnWidth:function(n,e){return[Math.max(Ke(),n+e)-n]},minCellWidth:Ke,setElementWidth:Io,adjustTableWidth:function(n){var e=o()+n;Io(t,e),r.set(e)},isRelative:!1,label:"pixel"}},rc=function(e){return jo(e).fold(function(){return nc(e)},function(n){return function(n,e){var t=qo().exec(e);if(null!==t)return ec(t[1],n);var r=Vo().exec(e);if(null!==r){var o=parseInt(r[1],10);return tc(o,n)}var u=uo(n);return tc(u,n)}(e,n)})},oc=tc,uc=ec,ic=function(n,e){if(ji(n)){var t=Yi(n,e.dom).filter(Ji).getOrThunk(function(){return Ru(e)});return uc(t,e)}return _i(n)?oc(uo(e),e):rc(e)},cc=function(n){ke(n,"width")},ac=function(n,e){var t=uo(n)+"px";Cu(n,S.some(t),S.none(),e),cc(n)},lc=function(n,e){var t,r,o,u=ic(n,e);r=u,o=Ho(t=e),Cu(t,S.some(o),S.none(),r),cc(t)},fc=function(n,e){var t=ic(n,e);ac(e,t)},sc=function(n){He(n,"width");var e=nt(n),t=0<e.length?e:Ze(n);E(t,function(n){He(n,"width"),cc(n)}),cc(n)},dc=function(){var n=Dn.fromTag("div");return ze(n,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),xt(ve(Dn.fromDom(document)),n),n},mc="bar-",gc=function(n){return"false"!==Ie(n,"data-mce-resize")},pc=function(f){var s,d,a=S.none(),i=S.none(),c=S.none(),o=function(n){return"TABLE"===n.nodeName},n=function(){return i},m=function(n){return ic(f,n)},g=function(){return Li(f)?{resizeTable:function(n,e,t){t&&n(e)},clampTableDelta:function(n,e,t,r,o){if(o){if(0<=t)return t;var u=k(n,function(n,e){return n+e-r},0);return Math.max(-u,t)}return cu(n,e,t,r)},calcLeftEdgeDeltas:i=function(n,e,t,r,o){var u=au(n,0<=r?t:e,r,o);return uu(n,e,t+1,[u,-u],ou)},calcMiddleDeltas:function(n,e,t,r,o,u){return i(n,t,r,o,u)},calcRightEdgeDeltas:function(n,e,t,r,o,u){if(u)return ou(n);var i=r/n.length;return B(n,b(i))}}:lu();var i},u=function(n,e,t){var r,o,u,i,c,a,l=tn(e,"e");""===d&&lc(f,n),t!==s&&""!==d?(_e(n,"width",d),r=g(),o=m(n),u=Li(f)||l?Du(n).columns-1:0,tu(n,t-s,u,r,o)):Ji(d)&&(i=parseFloat(d.replace("%","")),_e(n,"width",t*i/s+"%")),/^(\d+(\.\d+)?)px$/.test(d)&&(c=n,a=ft.fromTable(c),ft.hasColumns(a)||E(Ze(c),function(n){var e=We(n,"width");_e(n,"width",e),ke(n,"width")}))};return f.on("init",function(){var n,e,t,r,o,u=(e=gc,(n=f).inline?su(Vi(n),dc(),e):fu(Dn.fromDom(n.getDoc()),e));c=S.some(u),o=f.getParam("object_resizing",!0),(p(o)?"table"===o:o)&&f.getParam("table_resize_bars",!0,"boolean")&&(t=g(),(r=bi(u,t,m)).on(),r.events.startDrag.bind(function(n){a=S.some(f.selection.getRng())}),r.events.beforeResize.bind(function(n){var e,t,r,o,u,i=n.table.dom;e=f,r=Ui(t=i),o=$i(i),u=mc+n.type,e.fire("ObjectResizeStart",{target:t,width:r,height:o,origin:u})}),r.events.afterResize.bind(function(n){var e,t,r,o,u,i=n.table,c=i.dom;Xi(i),a.each(function(n){f.selection.setRng(n),f.focus()}),e=f,r=Ui(t=c),o=$i(c),u=mc+n.type,e.fire("ObjectResized",{target:t,width:r,height:o,origin:u}),f.undoManager.add()}),i=S.some(r))}),f.on("ObjectResizeStart",function(n){var e,t=n.target;o(t)&&(e=Dn.fromDom(t),E(f.dom.select(".mce-clonedresizable"),function(n){f.dom.addClass(n,"mce-"+Fi(f)+"-columns")}),!xu(e)&&_i(f)?fc(f,e):!Su(e)&&ji(f)&&lc(f,e),Tu(e)&&en(n.origin,mc)&&lc(f,e),s=n.width,d=zi(f)?"":Yi(f,t).getOr(""))}),f.on("ObjectResized",function(n){var e,t,r=n.target;o(r)&&(e=Dn.fromDom(r),t=n.origin,en(t,"corner-")&&u(e,t,n.width),Xi(e))}),f.on("SwitchMode",function(){i.each(function(n){f.mode.isReadOnly()?n.hideBars():n.showBars()})}),{lazyResize:n,lazyWire:function(){return c.getOr(fu(Dn.fromDom(f.getBody()),gc))},destroy:function(){i.each(function(n){n.destroy()}),c.each(function(n){var e;e=n,f.inline&&At(e.parent())})}}},hc=function(n,e){return{element:n,offset:e}},vc=function(e,n,t){return e.property().isText(n)&&0===e.property().getText(n).trim().length||e.property().isComment(n)?t(n).bind(function(n){return vc(e,n,t).orThunk(function(){return S.some(n)})}):S.none()},bc=function(n,e){return n.property().isText(e)?n.property().getText(e).length:n.property().children(e).length},wc=function(n,e){var t=vc(n,e,n.query().prevSibling).getOr(e);if(n.property().isText(t))return hc(t,bc(n,t));var r=n.property().children(t);return 0<r.length?wc(n,r[r.length-1]):hc(t,bc(n,t))},yc=wc,Cc=zt(),Sc=function(t,r){jo(t).bind(function(n){return xo(n,["fixed","relative","empty"])}).each(function(n){var e=n.value/2;Lo(t,e,n.unit),Lo(r,e,n.unit)})},xc=function(n,e,t){n.cells[e]=t},Tc=function(n,e){return $n(e,n.section)},Rc=function(n,e){var t=n.cells,r=B(t,e);return $n(r,n.section)},Dc=function(n,e){return n.cells[e]},Oc=function(n,e){return Dc(n,e).element},Ac=function(n){return n.cells.length},Bc=function(n){var e=function(n,e){for(var t=[],r=[],o=0,u=n.length;o<u;o++){var i=n[o];(e(i,o)?t:r).push(i)}return{pass:t,fail:r}}(n,function(n){return"colgroup"===n.section});return{rows:e.fail,cols:e.pass}},Ec=function(n){for(var e=[],t=function(n){e.push(n)},r=0;r<n.length;r++)n[r].each(t);return e},Ic=function(n,e,t,r){t===r?ke(n,e):Be(n,e,t)},Pc=function(n,e,t){F(ye(n,e)).fold(function(){return St(n,t)},function(n){return Ct(n,t)})},kc=function(c,n){var t=[],r=[],a=function(n){return B(n,function(n){n.isNew&&t.push(n.element);var e=n.element;return Ot(e),E(n.cells,function(n){n.isNew&&r.push(n.element),Ic(n.element,"colspan",n.colspan,1),Ic(n.element,"rowspan",n.rowspan,1),xt(e,n.element)}),e})},l=function(n){return _(n,function(n){return B(n.cells,function(n){return Ic(n.element,"span",n.colspan,1),n.element})})},o=function(n,e){var t,r,o,u=(o=Re(t=c,r=e).getOrThunk(function(){var n=Dn.fromTag(r,ee(t).dom);return"thead"===r?Pc(t,"caption,colgroup",n):"colgroup"===r?Pc(t,"caption",n):xt(t,n),n}),Ot(o),o),i=("colgroup"===e?l:a)(n);Dt(u,i)},e=function(n,e){0<n.length?o(n,e):Re(c,e).each(At)},u=[],i=[],f=[],s=[];return E(n,function(n){switch(n.section){case"thead":u.push(n);break;case"tbody":i.push(n);break;case"tfoot":f.push(n);break;case"colgroup":s.push(n)}}),e(s,"colgroup"),e(u,"thead"),e(i,"tbody"),e(f,"tfoot"),{newRows:t,newCells:r}},Mc=function(n,e){if(0===n.length)return 0;var t=n[0];return N(n,function(n){return!e(t.element,n.element)}).fold(function(){return n.length},function(n){return n})},Nc=function(n,e,t,r){var o,u=n[e].cells.slice(t),i=Mc(u,r),c=(o=t,B(n,function(n){return Dc(n,o)}).slice(e));return{colspan:i,rowspan:Mc(c,r)}},jc=function(o,u){var i=B(o,function(n){return B(n.cells,f)});return B(o,function(n,r){return{details:_(n.cells,function(n,e){if(!1!==i[r][e])return[];var t=Nc(o,r,e,u);return function(n,e,t,r){for(var o=n;o<n+t;o++)for(var u=e;u<e+r;u++)i[o][u]=!0}(r,e,t.rowspan,t.colspan),[{element:n.element,rowspan:t.rowspan,colspan:t.colspan,isNew:n.isNew}]}),section:n.section}})},_c=function(n,e,t){var r,o=[];ft.hasColumns(n)&&(r=B(ft.justColumns(n),function(n){return Un(n.element,t)}),o.push($n(r,"colgroup")));for(var u=0;u<n.grid.rows;u++){for(var i=[],c=0;c<n.grid.columns;c++){var a=ft.getAt(n,u,c).map(function(n){return Un(n.element,t)}).getOrThunk(function(){return Un(e.gap(),!0)});i.push(a)}var l=$n(i,n.all[u].section);o.push(l)}return o},zc=function(n,r){return B(n,function(n){var e,t=(e=n.details,L(e,function(n){return re(n.element).map(function(n){var e=re(n).isNone();return Un(n,e)})}).getOrThunk(function(){return Un(r.row(),!0)}));return{element:t.element,cells:n.details,section:n.section,isNew:t.isNew}})},Wc=function(n,e){var t=jc(n,Bn);return zc(t,e)},Fc=function(n,e){return L(n.all,function(n){return M(n.cells,function(n){return Bn(e,n.element)})})},Lc=function(a,e,l,f,s){return function(r,o,n,u,i){var c=ft.fromTable(o);return e(c,n).map(function(n){var e=_c(c,u,!1),t=a(e,n,Bn,s(u));return{grid:Wc(t.grid,u),cursor:t.cursor}}).fold(function(){return S.none()},function(n){var e=kc(o,n.grid),t=S.from(i).getOrThunk(function(){return rc(o)});return l(o,n.grid,t),f(o),di(r,o),S.some({cursor:n.cursor,newRows:e.newRows,newCells:e.newCells})})}},Hc=function(e,n){return Qe(n.element).bind(function(n){return Fc(e,n)})},qc=function(e,n){var t=B(n.selection,function(n){return Qe(n).bind(function(n){return Fc(e,n)})}),r=Ec(t);return 0<r.length?S.some({cells:r,generators:n.generators,clipboard:n.clipboard}):S.none()},Vc=function(e,n){var t=B(n.selection,function(n){return Qe(n).bind(function(n){return Fc(e,n)})}),r=Ec(t);return 0<r.length?S.some(r):S.none()},Uc=function(n,e,t,r){for(var o=Bc(n).rows,u=!0,i=0;i<o.length;i++)for(var c=0;c<Ac(o[0]);c++){var a=t(Oc(o[i],c),e);!0===a&&!1===u?xc(o[i],c,Un(r(),!0)):!0===a&&(u=!1)}return n},$c=function(n,e,u,i){var t,r,o,c=Bc(n).rows;return 0<e&&e<c.length&&(t=c[e-1].cells,o=u,r=k(t,function(n,e){return O(n,function(n){return o(n.element,e.element)})?n:n.concat([e])},[]),E(r,function(r){for(var o=S.none(),n=e;n<c.length;n++)!function(t){for(var n=0;n<Ac(c[0]);n++)!function(e){var n=c[t].cells[e];u(n.element,r.element)&&(o.isNone()&&(o=S.some(i())),o.each(function(n){xc(c[t],e,Un(n,!0))}))}(n)}(n)})),n},Gc=function(t){return{is:function(n){return t===n},isValue:C,isError:f,getOr:b(t),getOrThunk:b(t),getOrDie:b(t),or:function(n){return Gc(t)},orThunk:function(n){return Gc(t)},fold:function(n,e){return e(t)},map:function(n){return Gc(n(t))},mapError:function(n){return Gc(t)},each:function(n){n(t)},bind:function(n){return n(t)},exists:function(n){return n(t)},forall:function(n){return n(t)},toOptional:function(){return S.some(t)}}},Kc=function(t){return{is:f,isValue:f,isError:C,getOr:u,getOrThunk:function(n){return n()},getOrDie:function(){return n=String(t),function(){throw new Error(n)}();var n},or:function(n){return n},orThunk:function(n){return n()},fold:function(n,e){return n(t)},map:function(n){return Kc(t)},mapError:function(n){return Kc(n(t))},each:y,bind:function(n){return Kc(t)},exists:f,forall:C,toOptional:S.none}},Xc={value:Gc,error:Kc,fromOption:function(n,e){return n.fold(function(){return Kc(e)},Gc)}},Yc=function(n,e){return{rowDelta:0,colDelta:Ac(n[0])-Ac(e[0])}},Jc=function(n,e){return{rowDelta:n.length-e.length,colDelta:0}},Qc=function(n,e,t){var r="colgroup"===e.section?t.col:t.cell;return B(n,function(){return Un(r(),!0)})},Zc=function(e,n,t){return e.concat(A(n,function(){var n=e[e.length-1];return Tc(n,Qc(n.cells,n,t))}))},na=function(n,t,r){return B(n,function(n){var e=Qc(A(t,u),n,r);return Tc(n,n.cells.concat(e))})},ea=function(n,e,t){var r=e.colDelta<0?na:u;return(e.rowDelta<0?Zc:u)(r(n,Math.abs(e.colDelta),t),Math.abs(e.rowDelta),t)},ta=function(n,e,t,r,o){for(var u,i,c,a,l,f=n.row,s=n.column,d=f+t.length,m=s+Ac(t[0]),g=f;g<d;g++)for(var p=s;p<m;p++){c=p,a=void 0,a=w(o,Dc((u=e)[i=g],c).element),l=u[i],1<u.length&&1<Ac(l)&&(0<c&&a(Oc(l,c-1))||c<l.cells.length-1&&a(Oc(l,c+1))||0<i&&a(Oc(u[i-1],c))||i<u.length-1&&a(Oc(u[i+1],c)))&&Uc(e,Oc(e[g],p),o,r.cell);var h=Oc(t[g-f],p-s),v=r.replace(h);xc(e[g],p,Un(v,!0))}return e},ra=function(t,r,o,u,i){return function(n,e,t){if(n.row>=e.length||n.column>Ac(e[0]))return Xc.error("invalid start address out of table bounds, row: "+n.row+", column: "+n.column);var r=e.slice(n.row),o=r[0].cells.slice(n.column),u=Ac(t[0]),i=t.length;return Xc.value({rowDelta:r.length-i,colDelta:o.length-u})}(t,r,o).map(function(n){var e=ea(r,n,u);return ta(t,e,o,u,i)})},oa=function(r,n,e,t,o){var u,i,c,a;u=n,i=r,c=o,a=t.cell,0<i&&i<u[0].cells.length&&E(u,function(n){var e=n.cells[i-1],t=n.cells[i];c(t.element,e.element)&&xc(n,i,Un(a(),!0))});var l=Jc(e,n),f=ea(e,l,t),s=Jc(n,f),d=ea(n,s,t);return B(d,function(n,e){var t=n.cells.slice(0,r).concat(f[e].cells).concat(n.cells.slice(r,n.cells.length));return Tc(n,t)})},ua=function(n,e,t,r,o){$c(e,n,o,r.cell);var u=Yc(t,e),i=ea(t,u,r),c=Yc(e,i),a=ea(e,c,r),l=Bc(a),f=l.cols,s=l.rows;return f.concat(s.slice(0,n)).concat(i).concat(s.slice(n,s.length))},ia=function(n,t,e,r,o){var u=Bc(n),i=u.rows,c=u.cols,a=i.slice(0,t),l=i.slice(t),f=Rc(i[e],function(n,e){return 0<t&&t<i.length&&r(Oc(i[t-1],e),Oc(i[t],e))?Dc(i[t],e):Un(o(n.element,r),!0)});return c.concat(a).concat([f]).concat(l)},ca=function(n,v,b,w,y){return B(n,function(n){var e,t,r,o,u,i,c,a,l,f,s,d,m,g,p=0<v&&v<Ac(n)&&w(Oc(n,v-1),Oc(n,v)),h=(t=v,r=(e=n).section,o=p,u=b,i=w,c=y,"colgroup"!==r&&o?Dc(e,t):Un(c(Oc(e,u),i),!0));return l=v,f=h,s=(a=n).cells,d=s.slice(0,l),m=s.slice(l),g=d.concat([f]).concat(m),Tc(a,g)})},aa=function(n,t,r,o){return B(n,function(n){return Rc(n,function(n){return e=n,O(t,function(n){return r(e.element,n.element)})?Un(o(n.element,r),!0):n;var e})})},la=function(n,e,t,r){return Oc(n[e],t)!==undefined&&0<e&&r(Oc(n[e-1],t),Oc(n[e],t))},fa=function(n,e,t){return 0<e&&t(Oc(n,e-1),Oc(n,e))},sa=function(t,r,o,n){var e=_(t,function(n,e){return la(t,e,r,o)||fa(n,r,o)?[]:[Dc(n,r)]});return aa(t,e,o,n)},da=function(n,t,r,e){var o=Bc(n).rows,u=o[t],i=_(u.cells,function(n,e){return la(o,t,e,r)||fa(u,e,r)?[]:[n]});return aa(n,i,r,e)},ma=Pu(["cell","row","replace","gap","col","colgroup"]),ga=function(n){return{element:n,colspan:qe(n,"colspan",1),rowspan:qe(n,"rowspan",1)}},pa=function(e,t){void 0===t&&(t=ga),ma(e);var r=Zi(S.none()),o=function(n){return function(n){switch(Gn(n.element)){case"col":return e.col(n);default:return e.cell(n)}}(t(n))},u=function(n){var e=o(n);return r.get().isNone()&&r.set(S.some(e)),i=S.some({item:n,replacement:e}),e},i=S.none();return{getOrInit:function(e,t){return i.fold(function(){return u(e)},function(n){return t(e,n.item)?n.replacement:u(e)})},cursor:r.get}},ha=function(c,a){return function(r){var o=Zi(S.none());ma(r);var u=[],i=function(n){var e={scope:c},t=r.replace(n,a,e);return u.push({item:n,sub:t}),o.get().isNone()&&o.set(S.some(t)),t};return{replaceOrInit:function(e,t){return r=e,o=t,M(u,function(n){return o(n.item,r)}).fold(function(){return i(e)},function(n){return t(e,n.item)?n.sub:i(e)});var r,o},cursor:o.get}}},va=function(t){ma(t);var n=Zi(S.none());return{combine:function(e){return n.get().isNone()&&n.set(S.some(e)),function(){var n=t.cell({element:e,colspan:1,rowspan:1});return He(n,"width"),He(e,"width"),n}},cursor:n.get}},ba=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],wa=zt(),ya=function(n){return e=n,t=wa.property().name(e),D(ba,t);var e,t},Ca=function(n){return e=n,t=wa.property().name(e),D(["ol","ul"],t);var e,t},Sa=function(n){return e=n,D(["br","img","hr","input"],wa.property().name(e));var e},xa=function(n){var e,u=function(n){return"br"===Gn(n)},t=function(o){return dr(o).bind(function(t){var r=ie(t).map(function(n){return!!ya(n)||!!Sa(n)&&"img"!==Gn(n)}).getOr(!1);return re(t).map(function(n){return!0===r||("li"===Gn(e=n)||xe(e,Ca).isSome())||u(t)||ya(n)&&!Bn(o,n)?[]:[Dn.fromTag("br")];var e})}).getOr([])},r=0===(e=_(n,function(n){var e=ce(n);return z(e,function(n){return u(n)||Qn(n)&&0===Mt(n).trim().length})?[]:e.concat(t(n))})).length?[Dn.fromTag("br")]:e;Ot(n[0]),Dt(n[0],r)},Ta=function(n){0===Ze(n).length&&At(n)},Ra=function(n,e){return{grid:n,cursor:e}},Da=function(n,e,t){var r=Bc(n).rows;return Oa(r,e,t).orThunk(function(){return Oa(r,0,0)})},Oa=function(n,e,t){return S.from(n[e]).bind(function(n){return S.from(n.cells[t]).bind(function(n){return S.from(n.element)})})},Aa=function(n,e,t){var r=Bc(n).rows;return Ra(n,Oa(r,e,t))},Ba=function(n){return k(n,function(n,e){return O(n,function(n){return n.row===e.row})?n:n.concat([e])},[]).sort(function(n,e){return n.row-e.row})},Ea=function(n){return k(n,function(n,e){return O(n,function(n){return n.column===e.column})?n:n.concat([e])},[]).sort(function(n,e){return n.column-e.column})},Ia=function(n,e,t){var r,o,u=(r=n,o=t.section,ot(r,function(){return o})),i=ft.generate(u);return _c(i,e,!0)},Pa=function(n,e){var t=I(n,e);return 0===t.length?S.some("td"):t.length===n.length?S.some("th"):S.none()},ka=function(n,e,t){var r=ft.generate(e),o=t.getWidths(r,t);eu(r,o,t)},Ma=Lc(function(n,e,t,r){var o=e[0].row,u=e[0].row,i=Ba(e),c=k(i,function(n,e){return ia(n,u,o,t,r.getOrInit)},n);return Aa(c,u,e[0].column)},Vc,y,y,pa),Na=Lc(function(n,e,t,r){var o=Ba(e),u=o[o.length-1].row,i=o[o.length-1].row+o[o.length-1].rowspan,c=k(o,function(n,e){return ia(n,i,u,t,r.getOrInit)},n);return Aa(c,i,e[0].column)},Vc,y,y,pa),ja=Lc(function(n,e,t,r){var o=Ea(e),u=o[0].column,i=o[0].column,c=k(o,function(n,e){return ca(n,i,u,t,r.getOrInit)},n);return Aa(c,e[0].row,i)},Vc,ka,y,pa),_a=Lc(function(n,e,t,r){var o=e[e.length-1].column,u=e[e.length-1].column+e[e.length-1].colspan,i=Ea(e),c=k(i,function(n,e){return ca(n,u,o,t,r.getOrInit)},n);return Aa(c,e[0].row,u)},Vc,ka,y,pa),za=Lc(function(n,e,t,r){var o,u,i,c,a=Ea(e),l=(o=n,u=a[0].column,i=a[a.length-1].column,c=B(o,function(n){var e=n.cells.slice(0,u).concat(n.cells.slice(i+1));return $n(e,n.section)}),I(c,function(n){return 0<n.cells.length})),f=Da(l,e[0].row,e[0].column);return Ra(l,f)},Vc,ka,Ta,pa),Wa=Lc(function(n,e,t,r){var o,u,i,c,a,l=Ba(e),f=(o=n,u=l[0].row,i=l[l.length-1].row,c=Bc(o),a=c.rows,c.cols.concat(a.slice(0,u)).concat(a.slice(i+1))),s=Da(f,e[0].row,e[0].column);return Ra(f,s)},Vc,y,Ta,pa),Fa=Lc(function(n,e,t,r){var o=sa(n,e.column,t,r.replaceOrInit);return Aa(o,e.row,e.column)},Hc,y,y,ha("row","th")),La=Lc(function(n,e,t,r){var o=sa(n,e.column,t,r.replaceOrInit);return Aa(o,e.row,e.column)},Hc,y,y,ha(null,"td")),Ha=(Lc(function(n,e,t,r){var o=da(n,e.row,t,r.replaceOrInit);return Aa(o,e.row,e.column)},Hc,y,y,ha("col","th")),Lc(function(n,e,t,r){var o=da(n,e.row,t,r.replaceOrInit);return Aa(o,e.row,e.column)},Hc,y,y,ha(null,"td")),Lc(function(n,e,t,r){var o=e.cells;xa(o);var u=function(n,e,t){var r=Bc(n).rows;if(0===r.length)return n;for(var o=e.startRow;o<=e.finishRow;o++)for(var u=e.startCol;u<=e.finishCol;u++)xc(r[o],u,Un(t(),!1));return n}(n,e.bounds,b(o[0]));return Ra(u,S.from(o[0]))},function(n,e){return e.mergable},y,y,va)),qa=Lc(function(n,e,t,r){var o=P(e,function(n,e){return Uc(n,e,t,r.combine(e))},n);return Ra(o,S.from(e[0]))},function(n,e){return e.unmergable},ka,y,va),Va=Lc(function(n,t,e,r){var o,u,i,c=(o=t.clipboard,u=t.generators,i=ft.fromTable(o),_c(i,u,!0)),a={row:t.row,column:t.column};return ra(a,n,c,t.generators,e).fold(function(){return Ra(n,S.some(t.element))},function(n){var e=Da(n,t.row,t.column);return Ra(n,e)})},function(e,t){return Qe(t.element).bind(function(n){return Fc(e,n).map(function(n){return H(H({},n),{generators:t.generators,clipboard:t.clipboard})})})},ka,y,pa),Ua=Lc(function(n,e,t,r){var o=Bc(n).rows,u=e.cells[0].column,i=o[e.cells[0].row],c=Ia(e.clipboard,e.generators,i),a=oa(u,n,c,e.generators,t),l=Da(a,e.cells[0].row,e.cells[0].column);return Ra(a,l)},qc,y,y,pa),$a=Lc(function(n,e,t,r){var o=Bc(n).rows,u=e.cells[e.cells.length-1].column+e.cells[e.cells.length-1].colspan,i=o[e.cells[0].row],c=Ia(e.clipboard,e.generators,i),a=oa(u,n,c,e.generators,t),l=Da(a,e.cells[0].row,e.cells[0].column);return Ra(a,l)},qc,y,y,pa),Ga=Lc(function(n,e,t,r){var o=Bc(n).rows,u=e.cells[0].row,i=o[u],c=Ia(e.clipboard,e.generators,i),a=ua(u,n,c,e.generators,t),l=Da(a,e.cells[0].row,e.cells[0].column);return Ra(a,l)},qc,y,y,pa),Ka=Lc(function(n,e,t,r){var o=Bc(n).rows,u=e.cells[e.cells.length-1].row+e.cells[e.cells.length-1].rowspan,i=o[e.cells[0].row],c=Ia(e.clipboard,e.generators,i),a=ua(u,n,c,e.generators,t),l=Da(a,e.cells[0].row,e.cells[0].column);return Ra(a,l)},qc,y,y,pa),Xa=function(n,e){var u=ft.fromTable(n);return Vc(u,e).bind(function(n){var e=n[n.length-1],t=n[0].column,r=e.column+e.colspan,o=j(B(u.all,function(n){return I(n.cells,function(n){return n.column>=t&&n.column<r})}));return Pa(o,function(n){return"th"===Gn(n.element)})}).getOr("")},Ya=function(n){return qi(n.parentNode)},Ja=function(n,e){var t="thead"===Ya(e),r=!O(e.cells,function(n){return"th"!==qi(n)});return t||r?S.some({thead:t,ths:r}):S.none()},Qa=function(n,e){return"thead"===(t=Ja(0,e).fold(function(){return Ya(e)},function(n){return"thead"}))?"header":"tfoot"===t?"footer":"body";var t},Za=function(e,n,t){var r,o,u=e.getParent(n,"table"),i=n.parentNode,c=qi(i);t!==c&&((r=e.select(t,u)[0])||(r=e.create(t),o=u.firstChild,"thead"===t?F(ye(Dn.fromDom(u),"caption,colgroup")).fold(function(){return u.insertBefore(r,o)},function(n){return e.insertAfter(r,n.dom)}):u.appendChild(r)),"tbody"===t&&"thead"===c&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),i.hasChildNodes()||e.remove(i))},nl=function(t,n,r,o){return E(n,function(n){var e=qi(n)!==r?t.rename(n,r):n;t.setAttrib(e,"scope",o)})},el=function(n,e,t){var r,o,u,i=n.dom;"header"===t?(o="auto"===(r=Wi(n))?(u=et(Dn.fromDom(e.cells[0])).map(tt).getOr([]),L(u,function(n){return Ja(0,n.dom)}).map(function(n){return n.thead&&n.ths?"sectionCells":n.thead?"section":"cells"}).getOr("section")):r,nl(i,e.cells,"section"===o?"td":"th","col"),Za(i,e,"cells"===o?"tbody":"thead")):(nl(i,e.cells,"td",null),Za(i,e,"footer"===t?"tfoot":"tbody"))},tl=function(o){return function(n){var e,t=Gn(n),r="col"===t||"colgroup"===t?et(e=n).bind(function(n){return Yt(n,Pr.firstSelectedSelector)}).fold(function(){return e},function(n){return n[0]}):n;return Oe(r,o)}},rl=tl("th,td"),ol=tl("th,td,caption"),ul=function(n,e){return rl(n).map(function(n){return Ar(e)}).getOr([])},il=function(n,t){var e,r,o,u=rl(n),i=u.bind(function(n){return et(n)}).map(tt);return r=i,o=function(e,n){return I(n,function(n){return O(Or(n.dom.cells),function(n){return"1"===Ie(n,t)||Bn(n,e)})})},((e=u).isSome()&&r.isSome()?S.some(o(e.getOrDie(),r.getOrDie())):S.none()).getOr([])},cl=function(f,n,r){var e=function(n){return"table"===Gn(Vi(n))},s=Hi(f),t=function(i,c,a,l){return function(e,n){Xi(e);var t=l(),r=Dn.fromDom(f.getDoc()),o=Rr(a,r,s),u=ic(f,e);return c(e)?i(t,e,n,o,u).bind(function(n){return E(n.newRows,function(n){wi(f,n.dom)}),E(n.newCells,function(n){yi(f,n.dom)}),xi(f,e.dom),n.cursor.map(function(n){var e=yc(Cc,n),t=f.dom.createRng();return t.setStart(e.element.dom,e.offset),t.setEnd(e.element.dom,e.offset),t})}):S.none()}},o=t(Wa,function(n){return!1===e(f)||1<Du(n).rows},y,n),u=t(za,function(n){return!1===e(f)||1<Du(n).columns},y,n),i=t(Ma,C,y,n),c=t(Na,C,y,n),a=t(ja,C,Sc,n),l=t(_a,C,Sc,n),d=t(Ha,C,y,n),m=t(qa,C,y,n),g=t(Ua,C,y,n),p=t($a,C,y,n),h=t(Ga,C,y,n),v=t(Ka,C,y,n),b=t(Va,C,y,n),w=function(n,e){return Fn(n,"type").filter(function(n){return D(e,n)})};return{deleteRow:o,deleteColumn:u,insertRowsBefore:i,insertRowsAfter:c,insertColumnsBefore:a,insertColumnsAfter:l,mergeCells:d,unmergeCells:m,pasteColsBefore:g,pasteColsAfter:p,pasteRowsBefore:h,pasteRowsAfter:v,pasteCells:b,setTableCellType:function(t,n){return w(n,["td","th"]).each(function(n){var e=B(ul(Qi(t),r),function(n){return n.dom});nl(t.dom,e,n,null)})},setTableRowType:function(t,n){return w(n,["header","body","footer"]).each(function(e){B(il(Qi(t),Pr.selected),function(n){return el(t,n.dom,e)})})},makeColumnHeader:t(Fa,C,y,n),unmakeColumnHeader:t(La,C,y,n),getTableRowType:function(n){var e=il(Qi(n),Pr.selected);if(0<e.length){var t=B(e,function(n){return Qa(0,n.dom)}),r=D(t,"header"),o=D(t,"footer");if(r||o){var u=D(t,"body");return!r||u||o?r||u||!o?"":"footer":"header"}return"body"}},getTableCellType:function(n){return Pa(ul(Qi(n),r),function(n){return"th"===Gn(n)}).getOr("")},getTableColType:Xa}},al={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},colGroups:!1},ll=function(n,e,t,r){for(var o=Dn.fromTag("tr"),u=0;u<n;u++){var i=r<e||u<t?Dn.fromTag("th"):Dn.fromTag("td");u<t&&Be(i,"scope","row"),r<e&&Be(i,"scope","col"),xt(i,Dn.fromTag("br")),xt(o,i)}return o},fl=function(n){var e=Dn.fromTag("colgroup");return A(n,function(){return xt(e,Dn.fromTag("col"))}),e},sl=function(n,e,t,r){return A(n,function(n){return ll(e,t,r,n)})},dl=function(n,e){n.selection.select(e.dom,!0),n.selection.collapse(!0)},ml=function(o,n,e,t,r){var u=Ei(o),i={styles:u,attributes:Bi(o),colGroups:o.getParam("table_use_colgroups",!1,"boolean")},c=function(n,e,t,r,o,u){void 0===u&&(u=al);var i=Dn.fromTag("table"),c="cells"!==o;ze(i,u.styles),Ee(i,u.attributes),u.colGroups&&xt(i,fl(e));var a,l,f=Math.min(n,t);c&&0<t&&(a=Dn.fromTag("thead"),xt(i,a),l=sl(t,e,"sectionCells"===o?f:0,r),Dt(a,l));var s=Dn.fromTag("tbody");xt(i,s);var d=sl(c?n-f:n,e,c?0:t,r);return Dt(s,d),i}(e,n,r,t,Wi(o),i);Be(c,"data-mce-id","__mce");var a,l,f,s=(a=c,l=Dn.fromTag("div"),f=Dn.fromDom(a.dom.cloneNode(!0)),xt(l,f),l.dom.innerHTML);return o.insertContent(s),De(Vi(o),'table[data-mce-id="__mce"]').map(function(n){var e,t,r;return _i(o)?fc(o,n):zi(o)?sc(n):(ji(o)||(e=u.width,p(e)&&-1!==e.indexOf("%")))&&lc(o,n),Xi(n),ke(n,"data-mce-id"),t=o,E(Ce(n,"tr"),function(n){wi(t,n.dom),E(Ce(n,"th,td"),function(n){yi(t,n.dom)})}),r=o,De(n,"td,th").each(w(dl,r)),n.dom}).getOr(null)},gl=function(n,e,t,r,o){void 0===r&&(r={});var u=function(n){return v(n)&&0<n};if(u(e)&&u(t)){var i=r.headerRows||0,c=r.headerColumns||0;return ml(n,t,e,c,i)}return console.error(o),null},pl=function(n){return function(){return n().fold(function(){return[]},function(n){return B(n,function(n){return n.dom})})}},hl=function(t){return function(n){var e=0<n.length?S.some(Or(n)):S.none();t(e)}},vl=function(r,n,e,t){return{insertTable:function(n,e,t){return void 0===t&&(t={}),gl(r,e,n,t,"Invalid values for insertTable - rows and columns values are required to insert a table.")},setClipboardRows:hl(n.setRows),getClipboardRows:pl(n.getRows),setClipboardCols:hl(n.setColumns),getClipboardCols:pl(n.getColumns),resizeHandler:e,selectionTargets:t}},bl=function(n,e,t){var r=qe(n,e,1);1===t||r<=1?ke(n,e):Be(n,e,Math.min(t,r))},wl=function(n,e){var i=ft.fromTable(n);return Vc(i,e).map(function(n){var o,u,e=n[n.length-1],t=n[0].column,r=e.column+e.colspan;return q(function(n,t,r){if(ft.hasColumns(n)){var e=I(ft.justColumns(n),function(n){return n.column>=t&&n.column<r}),o=B(e,function(n){var e=hr(n.element);return bl(e,"span",r-t),e}),u=Dn.fromTag("colgroup");return Dt(u,o),[u]}return[]}(i,t,r),(o=t,u=r,B(i.all,function(n){var e=I(n.cells,function(n){return n.column>=o&&n.column<u}),t=B(e,function(n){var e=hr(n.element);return bl(e,"colspan",u-o),e}),r=Dn.fromTag("tr");return Dt(r,t),r})))})},yl=function(n,e,o){var u=ft.fromTable(n);return Vc(u,e).map(function(n){var e=_c(u,o,!1),t=Bc(e).rows.slice(n[0].row,n[n.length-1].row+n[n.length-1].rowspan),r=Wc(t,o);return B(r,function(n){var t=pr(n.element);return E(n.cells,function(n){var e=hr(n.element);Ic(e,"colspan",n.colspan,1),Ic(e,"rowspan",n.rowspan,1),xt(t,e)}),t})})},Cl=tinymce.util.Tools.resolve("tinymce.util.Tools"),Sl=function(o,n,u){return function(n,e){for(var t=0;t<e.length;t++){var r=o.getStyle(e[t],u);if(void 0===n&&(n=r),n!==r)return""}return n}(void 0,o.select("td,th",n))},xl=function(n,e,t){t&&n.formatter.apply("align"+t,{},e)},Tl=function(e,t){Cl.each("left center right".split(" "),function(n){e.formatter.remove("align"+n,{},t)})},Rl=function(n){return Ln(e=n,t="menu")&&e[t]!==undefined&&null!==e[t];var e,t},Dl=function(n,e){return(e||[]).concat(B(n,function(n){var e=n.text||n.title;return Rl(n)?{text:e,items:Dl(n.menu)}:{text:e,value:n.value}}))},Ol=function(e){return function(n){return en(n,"rgb")?e.toHex(n):n}},Al=function(n,e){var t=Dn.fromDom(e);return{borderwidth:Le(t,"border-width").getOr(""),borderstyle:Le(t,"border-style").getOr(""),bordercolor:Le(t,"border-color").map(Ol(n)).getOr(""),backgroundcolor:Le(t,"background-color").map(Ol(n)).getOr("")}},Bl=function(n){var o=n[0],e=n.slice(1);return E(e,function(n){E(kn(o),function(r){Nn(n,function(n,e){var t=o[r];""!==t&&r===e&&t!==n&&(o[r]="")})})}),o},El=function(n){var e=[{name:"borderstyle",type:"listbox",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}];return{title:"Advanced",name:"advanced",items:"cell"===n?[{name:"borderwidth",type:"input",label:"Border width"}].concat(e):e}},Il=function(n,e,t,r){return M(n,function(n){return t.formatter.matchNode(r,e+n)}).getOr("")},Pl=w(Il,["left","center","right"],"align"),kl=w(Il,["top","middle","bottom"],"valign"),Ml=function(n,e){var t,r,o,u,i=Ei(n),c=Bi(n),a=e?(t=n.dom,{borderstyle:Fn(i,"border-style").getOr(""),bordercolor:Ol(t)(Fn(i,"border-color").getOr("")),backgroundcolor:Ol(t)(Fn(i,"background-color").getOr(""))}):{};return H(H(H(H(H(H({},{height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,"class":"",align:"",border:""}),i),c),a),(u=i["border-width"],Ni(n)&&u?{border:u}:Fn(c,"border").fold(function(){return{}},function(n){return{border:n}}))),(r=Fn(i,"border-spacing").or(Fn(c,"cellspacing")).fold(function(){return{}},function(n){return{cellspacing:n}}),o=Fn(i,"border-padding").or(Fn(c,"cellpadding")).fold(function(){return{}},function(n){return{cellpadding:n}}),H(H({},r),o)))},Nl=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"listbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"listbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"listbox",label:"H Align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"listbox",label:"V Align",items:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}],jl=function(n){return Nl.concat((0<(e=Dl(n.getParam("table_cell_class_list",[],"array"))).length?S.some({name:"class",type:"listbox",label:"Class",items:e}):S.none()).toArray());var e},_l=function(u){return function(t,r){var o=t.dom;return{setAttrib:function(n,e){u&&!e||o.setAttrib(r,n,e)},setStyle:function(n,e){u&&!e||o.setStyle(r,n,e)},setFormat:function(n,e){u&&!e||(""===e?t.formatter.remove(n,{value:null},r,!0):t.formatter.apply(n,{value:e},r))}}}},zl={normal:_l(!1),ifTruthy:_l(!0)},Wl=function(o){return et(o[0]).map(function(n){var e=ft.fromTable(n),t=ft.justCells(e),r=I(t,function(e){return O(o,function(n){return Bn(e.element,n)})});return B(r,function(n){return{element:n.element.dom,column:ft.getColumnAt(e,n.column).map(function(n){return n.element.dom})}})})},Fl=function(p,n,h){var e,v=p.dom,b=1===n.length;1<=n.length&&(e=et(n[0]),Wl(n).each(function(n){E(n,function(n){var e,t,r,o,u,i,c,a,l,f,s=n.element,d=h.celltype&&qi(s)!==h.celltype?v.rename(s,h.celltype):s,m=b?zl.normal(p,d):zl.ifTruthy(p,d),g=n.column.map(function(n){return b?zl.normal(p,n):zl.ifTruthy(p,n)}).getOr(m);t=g,r=h,(e=m).setAttrib("scope",r.scope),e.setAttrib("class",r["class"]),e.setStyle("height",Ki(r.height)),t.setStyle("width",Ki(r.width)),Pi(p)&&(u=h,(o=m).setFormat("tablecellbackgroundcolor",u.backgroundcolor),o.setFormat("tablecellbordercolor",u.bordercolor),o.setFormat("tablecellborderstyle",u.borderstyle),o.setFormat("tablecellborderwidth",Ki(u.borderwidth))),b&&(Tl(p,d),i=p,c=d,Cl.each("top middle bottom".split(" "),function(n){i.formatter.remove("valign"+n,{},c)})),h.halign&&xl(p,d,h.halign),h.valign&&(a=p,l=d,(f=h.valign)&&a.formatter.apply("valign"+f,{},l))})}),e.each(function(n){return xi(p,n.dom)}))},Ll=function(n,e,t){var r=t.getData();t.close(),n.undoManager.transact(function(){Fl(n,e,r),n.focus()})},Hl=function(a,n){var e=Wl(n).map(function(n){return B(n,function(n){return e=a,t=n.element,r=Pi(a),o=n.column,u=e.dom,i=o.getOr(t),H({width:(c=function(n,e){return u.getStyle(n,e)||u.getAttrib(n,e)})(i,"width"),height:c(t,"height"),scope:u.getAttrib(t,"scope"),celltype:qi(t),"class":u.getAttrib(t,"class",""),halign:Pl(e,t),valign:kl(e,t)},r?Al(u,t):{});var e,t,r,o,u,i,c})});return Bl(e.getOrDie())},ql=function(n,e){var t,r,o,u=ul(Qi(n),e);0!==u.length&&(t=Hl(n,u),r={type:"tabpanel",tabs:[{title:"General",name:"general",items:jl(n)},El("cell")]},o={type:"panel",items:[{type:"grid",columns:2,items:jl(n)}]},n.windowManager.open({title:"Cell Properties",size:"normal",body:Pi(n)?r:o,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:t,onSubmit:w(Ll,n,u)}))},Vl=[{type:"listbox",name:"type",label:"Row type",items:[{text:"Header",value:"header"},{text:"Body",value:"body"},{text:"Footer",value:"footer"}]},{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],Ul=function(n){return Vl.concat((0<(e=Dl(n.getParam("table_row_class_list",[],"array"))).length?S.some({name:"class",type:"listbox",label:"Class",items:e}):S.none()).toArray());var e},$l=function(i,n,c,a){var l=1===n.length;E(n,function(n){a.type!==qi(n.parentNode)&&el(i,n,a.type);var e,t,r,o,u=l?zl.normal(i,n):zl.ifTruthy(i,n);t=a,(e=u).setAttrib("scope",t.scope),e.setAttrib("class",t["class"]),e.setStyle("height",Ki(t.height)),ki(i)&&(o=a,(r=u).setStyle("background-color",o.backgroundcolor),r.setStyle("border-color",o.bordercolor),r.setStyle("border-style",o.borderstyle)),a.align!==c.align&&(Tl(i,n),xl(i,n,a.align))}),et(Dn.fromDom(n[0])).each(function(n){return xi(i,n.dom)})},Gl=function(n,e,t,r){var o=r.getData();r.close(),n.undoManager.transact(function(){$l(n,e,t,o),n.focus()})},Kl=function(u){var n,e,t,r,o=il(Qi(u),Pr.selected);0!==o.length&&(n=B(o,function(n){return e=u,t=n.dom,r=ki(u),o=e.dom,H({height:o.getStyle(t,"height")||o.getAttrib(t,"height"),scope:o.getAttrib(t,"scope"),"class":o.getAttrib(t,"class",""),type:Qa(0,t),align:Pl(e,t)},r?Al(o,t):{});var e,t,r,o}),e=Bl(n),t={type:"tabpanel",tabs:[{title:"General",name:"general",items:Ul(u)},El("row")]},r={type:"panel",items:[{type:"grid",columns:2,items:Ul(u)}]},u.windowManager.open({title:"Row Properties",size:"normal",body:ki(u)?t:r,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:e,onSubmit:w(Gl,u,B(o,function(n){return n.dom}),e)}))},Xl=tinymce.util.Tools.resolve("tinymce.Env"),Yl=function(n,e,t,r){if("TD"===e.tagName||"TH"===e.tagName)p(t)?n.setStyle(e,t,r):n.setStyle(e,t);else if(e.children)for(var o=0;o<e.children.length;o++)Yl(n,e.children[o],t,r)},Jl=function(t,r,n){var o,u=t.dom,i=n.getData();n.close(),""===i["class"]&&delete i["class"],t.undoManager.transact(function(){var n,e;r||(n=parseInt(i.cols,10)||1,e=parseInt(i.rows,10)||1,r=ml(t,n,e,0,0)),function(n,e,t){var r,o=n.dom,u={},i={};if(u["class"]=t["class"],i.height=Ki(t.height),o.getAttrib(e,"width")&&!Ni(n)?u.width=(r=t.width)?r.replace(/px$/,""):"":i.width=Ki(t.width),Ni(n)?(i["border-width"]=Ki(t.border),i["border-spacing"]=Ki(t.cellspacing)):(u.border=t.border,u.cellpadding=t.cellpadding,u.cellspacing=t.cellspacing),Ni(n)&&e.children)for(var c=0;c<e.children.length;c++)Yl(o,e.children[c],{"border-width":Ki(t.border),padding:Ki(t.cellpadding)}),Mi(n)&&Yl(o,e.children[c],{"border-color":t.bordercolor});Mi(n)&&(i["background-color"]=t.backgroundcolor,i["border-color"]=t.bordercolor,i["border-style"]=t.borderstyle),u.style=o.serializeStyle(H(H({},Ei(n)),i)),o.setAttribs(e,H(H({},Bi(n)),u)),xi(n,e)}(t,r,i),(o=u.select("caption",r)[0])&&!i.caption&&u.remove(o),!o&&i.caption&&((o=u.create("caption")).innerHTML=Xl.ie?"\xa0":'<br data-mce-bogus="1"/>',r.insertBefore(o,r.firstChild)),""===i.align?Tl(t,r):xl(t,r,i.align),t.focus(),t.addVisual()})},Ql=function(n,e){var t,r,o,u,i,c,a,l,f=n.dom,s=Ml(n,Mi(n));!1===e?(t=f.getParent(n.selection.getStart(),"table"))?(o=t,u=Mi(r=n),l=r.dom,s=H({width:l.getStyle(o,"width")||l.getAttrib(o,"width"),height:l.getStyle(o,"height")||l.getAttrib(o,"height"),cellspacing:l.getStyle(o,"border-spacing")||l.getAttrib(o,"cellspacing"),cellpadding:l.getAttrib(o,"cellpadding")||Sl(r.dom,o,"padding"),border:(i=l,c=o,a=Le(Dn.fromDom(c),"border-width"),Ni(r)&&a.isSome()?a.getOr(""):i.getAttrib(c,"border")||Sl(r.dom,c,"border-width")||Sl(r.dom,c,"border")),caption:!!l.select("caption",o)[0],"class":l.getAttrib(o,"class",""),align:Pl(r,o)},u?Al(l,o):{})):Mi(n)&&(s.borderstyle="",s.bordercolor="",s.backgroundcolor=""):(s.cols="1",s.rows="1",Mi(n)&&(s.borderstyle="",s.bordercolor="",s.backgroundcolor=""));var d=Dl(n.getParam("table_class_list",[],"array"));0<d.length&&s["class"]&&(s["class"]=s["class"].replace(/\s*mce\-item\-table\s*/g,""));var m,g,p,h,v={type:"grid",columns:2,items:(m=d,g=e?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],p=n.getParam("table_appearance_options",!0,"boolean")?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],h=0<m.length?[{type:"listbox",name:"class",label:"Class",items:m}]:[],g.concat([{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}]).concat(p).concat([{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]).concat(h))},b=Mi(n)?{type:"tabpanel",tabs:[{title:"General",name:"general",items:[v]},El("table")]}:{type:"panel",items:[v]};n.windowManager.open({title:"Table Properties",size:"normal",body:b,onSubmit:w(Jl,n,t),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:s})},Zl=function(n){return ol(Qi(n))},nf=function(n){return rl(Qi(n))},ef=function(c,t,a,l,e){var r=Gi(c),f=function(n){return et(n,r)},o=function(r){return nf(c).each(function(t){f(t).each(function(e){var n=Mr(l,e,t);r(e,n).each(function(n){c.selection.setRng(n),c.focus(),a.clear(e),Xi(e)})})})},u=function(){return nf(c).map(function(r){return f(r).bind(function(n){var e=Mr(l,n,r),t=Rr(y,Dn.fromDom(c.getDoc()),S.none());return yl(n,e,t)})})},i=function(){return nf(c).map(function(t){return f(t).bind(function(n){var e=Mr(l,n,t);return wl(n,e)})})},s=function(i,n){return n().each(function(n){var u=B(n,hr);nf(c).each(function(n){return f(n).each(function(e){var n,t,r=Dr(Dn.fromDom(c.getDoc())),o=(n=u,t=r,{selection:Ar(l),clipboard:n,generators:t});i(e,o).each(function(n){c.selection.setRng(n),c.focus(),a.clear(e)})})})})};Nn({mceTableSplitCells:function(){return o(t.unmergeCells)},mceTableMergeCells:function(){return o(t.mergeCells)},mceTableInsertRowBefore:function(){return o(t.insertRowsBefore)},mceTableInsertRowAfter:function(){return o(t.insertRowsAfter)},mceTableInsertColBefore:function(){return o(t.insertColumnsBefore)},mceTableInsertColAfter:function(){return o(t.insertColumnsAfter)},mceTableDeleteCol:function(){return o(t.deleteColumn)},mceTableDeleteRow:function(){return o(t.deleteRow)},mceTableCutCol:function(n){return i().each(function(n){e.setColumns(n),o(t.deleteColumn)})},mceTableCutRow:function(n){return u().each(function(n){e.setRows(n),o(t.deleteRow)})},mceTableCopyCol:function(n){return i().each(function(n){return e.setColumns(n)})},mceTableCopyRow:function(n){return u().each(function(n){return e.setRows(n)})},mceTablePasteColBefore:function(n){return s(t.pasteColsBefore,e.getColumns)},mceTablePasteColAfter:function(n){return s(t.pasteColsAfter,e.getColumns)},mceTablePasteRowBefore:function(n){return s(t.pasteRowsBefore,e.getRows)},mceTablePasteRowAfter:function(n){return s(t.pasteRowsAfter,e.getRows)},mceTableDelete:function(){return Zl(c).each(function(n){et(n,r).filter(d(r)).each(function(n){var e,t=Dn.fromText("");Ct(n,t),At(n),c.dom.isEmpty(c.getBody())?(c.setContent(""),c.selection.setCursorLocation()):((e=c.dom.createRng()).setStart(t.dom,0),e.setEnd(t.dom,0),c.selection.setRng(e),c.nodeChanged())})})},mceTableSizingMode:function(n,e){return t=e,Zl(c).each(function(n){zi(c)||_i(c)||ji(c)||et(n,r).each(function(n){"relative"!==t||Su(n)?"fixed"!==t||xu(n)?"responsive"!==t||Tu(n)||sc(n):fc(c,n):lc(c,n),Xi(n)})});var t}},function(n,e){return c.addCommand(e,n)}),Nn({mceTableCellType:function(n,e){return t.setTableCellType(c,e)},mceTableRowType:function(n,e){return t.setTableRowType(c,e)}},function(n,e){return c.addCommand(e,n)}),c.addCommand("mceTableColType",function(n,e){return Fn(e,"type").each(function(n){return o("th"===n?t.makeColumnHeader:t.unmakeColumnHeader)})}),Nn({mceTableProps:w(Ql,c,!1),mceTableRowProps:w(Kl,c),mceTableCellProps:w(ql,c,l)},function(n,e){return c.addCommand(e,function(){return n()})}),c.addCommand("mceInsertTable",function(n,e){m(e)&&0<kn(e).length?gl(c,e.rows,e.columns,e.options,"Invalid values for mceInsertTable - rows and columns values are required to insert a table."):Ql(c,!0)}),c.addCommand("mceTableApplyCellStyle",function(n,e){var r,t,o=function(n){return"tablecell"+n.toLowerCase().replace("-","")};!m(e)||0!==(r=ul(Qi(c),l)).length&&(function(n){for(var e in n)if(Mn.call(n,e))return!1;return!0}(t=zn(e,function(n,e){return c.formatter.has(o(e))&&p(n)}))||(Nn(t,function(e,t){E(r,function(n){zl.normal(c,n.dom).setFormat(o(t),e)})}),f(r[0]).each(function(n){return xi(c,n.dom,{structure:!1,style:!0})})))})},tf=function(t,r,o){var n=Gi(t);Nn({mceTableRowType:function(){return r.getTableRowType(t)},mceTableCellType:function(){return r.getTableCellType(t)},mceTableColType:function(){return rl(Qi(t)).bind(function(t){return et(t,n).map(function(n){var e=Mr(o,n,t);return r.getTableColType(n,e)})}).getOr("")}},function(n,e){return t.addQueryValueHandler(e,n)})},rf=function(){var e=Zi(S.none()),t=Zi(S.none()),r=function(n){n.set(S.none())};return{getRows:e.get,setRows:function(n){e.set(n),r(t)},clearRows:function(){return r(e)},getColumns:t.get,setColumns:function(n){t.set(n),r(e)},clearColumns:function(){return r(t)}}},of={tablecellbackgroundcolor:{selector:"td,th",styles:{backgroundColor:"%value"},remove_similar:!0},tablecellbordercolor:{selector:"td,th",styles:{borderColor:"%value"},remove_similar:!0},tablecellborderstyle:{selector:"td,th",styles:{borderStyle:"%value"},remove_similar:!0},tablecellborderwidth:{selector:"td,th",styles:{borderWidth:"%value"},remove_similar:!0}},uf=function(n){n.formatter.register(of)},cf=Qt([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),af=H(H({},cf),{none:function(n){return void 0===n&&(n=undefined),cf.none(n)}}),lf=function(t,n){return et(t,n).bind(function(n){var e=Ze(n);return N(e,function(n){return Bn(t,n)}).map(function(n){return{index:n,all:e}})})},ff=function(n,e,t,r){return{start:n,soffset:e,finish:t,foffset:r}},sf=Qt([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),df={before:sf.before,on:sf.on,after:sf.after,cata:function(n,e,t,r){return n.fold(e,t,r)},getStart:function(n){return n.fold(u,u,u)}},mf=Qt([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),gf={domRange:mf.domRange,relative:mf.relative,exact:mf.exact,exactFromRange:function(n){return mf.exact(n.start,n.soffset,n.finish,n.foffset)},getWin:function(n){var e,t=n.match({domRange:function(n){return Dn.fromDom(n.startContainer)},relative:function(n,e){return df.getStart(n)},exact:function(n,e,t,r){return n}});return e=t,Dn.fromDom(te(e).dom.defaultView)},range:ff},pf=function(n,e){return n.selectNodeContents(e.dom)},hf=function(n,e,t){var r,o,u=n.document.createRange();return r=u,e.fold(function(n){r.setStartBefore(n.dom)},function(n,e){r.setStart(n.dom,e)},function(n){r.setStartAfter(n.dom)}),o=u,t.fold(function(n){o.setEndBefore(n.dom)},function(n,e){o.setEnd(n.dom,e)},function(n){o.setEndAfter(n.dom)}),u},vf=function(n,e,t,r,o){var u=n.document.createRange();return u.setStart(e.dom,t),u.setEnd(r.dom,o),u},bf=function(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom,width:n.width,height:n.height}},wf=Qt([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),yf=function(n,e,t){return e(Dn.fromDom(t.startContainer),t.startOffset,Dn.fromDom(t.endContainer),t.endOffset)},Cf=function(n,e){var o,t,r,u=(o=n,e.match({domRange:function(n){return{ltr:b(n),rtl:S.none}},relative:function(n,e){return{ltr:U(function(){return hf(o,n,e)}),rtl:U(function(){return S.some(hf(o,e,n))})}},exact:function(n,e,t,r){return{ltr:U(function(){return vf(o,n,e,t,r)}),rtl:U(function(){return S.some(vf(o,t,r,n,e))})}}}));return(r=(t=u).ltr()).collapsed?t.rtl().filter(function(n){return!1===n.collapsed}).map(function(n){return wf.rtl(Dn.fromDom(n.endContainer),n.endOffset,Dn.fromDom(n.startContainer),n.startOffset)}).getOrThunk(function(){return yf(0,wf.ltr,r)}):yf(0,wf.ltr,r)},Sf=function(u,n){return Cf(u,n).match({ltr:function(n,e,t,r){var o=u.document.createRange();return o.setStart(n.dom,e),o.setEnd(t.dom,r),o},rtl:function(n,e,t,r){var o=u.document.createRange();return o.setStart(t.dom,r),o.setEnd(n.dom,e),o}})},xf=(wf.ltr,wf.rtl,function(n,e,t){return e>=n.left&&e<=n.right&&t>=n.top&&t<=n.bottom}),Tf=function(t,r,n,e,o){var u=function(n){var e=t.dom.createRange();return e.setStart(r.dom,n),e.collapse(!0),e},i=Mt(r).length,c=function(n,e,t,r,o){if(0===o)return 0;if(e===r)return o-1;for(var u=r,i=1;i<o;i++){var c=n(i),a=Math.abs(e-c.left);if(t<=c.bottom){if(t<c.top||u<a)return i-1;u=a}}return 0}(function(n){return u(n).getBoundingClientRect()},n,e,o.right,i);return u(c)},Rf=function(n,e,t,r){return Qn(e)?function(e,t,r,o){var n=e.dom.createRange();n.selectNode(t.dom);var u=n.getClientRects();return L(u,function(n){return xf(n,r,o)?S.some(n):S.none()}).map(function(n){return Tf(e,t,r,o,n)})}(n,e,t,r):(u=e,i=t,c=r,a=(o=n).dom.createRange(),l=ce(u),L(l,function(n){return a.selectNode(n.dom),xf(a.getBoundingClientRect(),i,c)?Rf(o,n,i,c):S.none()}));var o,u,i,c,a,l},Df=function(n,e){return e-n.left<n.right-e},Of=function(n,e,t){var r=n.dom.createRange();return r.selectNode(e.dom),r.collapse(t),r},Af=function(e,n,t){var r=e.dom.createRange();r.selectNode(n.dom);var o=r.getBoundingClientRect(),u=Df(o,t);return(!0===u?sr:dr)(n).map(function(n){return Of(e,n,u)})},Bf=function(n,e,t){var r=e.dom.getBoundingClientRect(),o=Df(r,t);return S.some(Of(n,e,o))},Ef=function(t,n,e){return S.from(t.dom.caretPositionFromPoint(n,e)).bind(function(n){if(null===n.offsetNode)return S.none();var e=t.dom.createRange();return e.setStart(n.offsetNode,n.offset),e.collapse(),S.some(e)})},If=function(n,e,t){return S.from(n.dom.caretRangeFromPoint(e,t))},Pf=function(n,e,t,r){var o=n.dom.createRange();o.selectNode(e.dom);var u=o.getBoundingClientRect();return function(n,e,t,r){var o=n.dom.createRange();o.selectNode(e.dom);var u=o.getBoundingClientRect(),i=Math.max(u.left,Math.min(u.right,t)),c=Math.max(u.top,Math.min(u.bottom,r));return Rf(n,e,i,c)}(n,e,Math.max(u.left,Math.min(u.right,t)),Math.max(u.top,Math.min(u.bottom,r)))},kf=function(o,u,e){return Dn.fromPoint(o,u,e).bind(function(r){var n=function(){return n=o,t=u,(0===ce(e=r).length?Bf:Af)(n,e,t);var n,e,t};return 0===ce(r).length?n():Pf(o,r,u,e).orThunk(n)})},Mf=document.caretPositionFromPoint?Ef:document.caretRangeFromPoint?If:kf,Nf=function(n,e){var t=Gn(n);return"input"===t?df.after(n):D(["br","img"],t)?0===e?df.before(n):df.after(n):df.on(n,e)},jf=function(n,e){var t=n.fold(df.before,Nf,df.after),r=e.fold(df.before,Nf,df.after);return gf.relative(t,r)},_f=function(n,e,t,r){var o=Nf(n,e),u=Nf(t,r);return gf.relative(o,u)},zf=function(n,e,t,r){var o,u,i,c,a,l=(u=e,i=t,c=r,(a=ee(o=n).dom.createRange()).setStart(o.dom,u),a.setEnd(i.dom,c),a),f=Bn(n,t)&&e===r;return l.collapsed&&!f},Wf=function(n){return S.from(n.getSelection())},Ff=function(n,e){Wf(n).each(function(n){n.removeAllRanges(),n.addRange(e)})},Lf=function(n,e,t,r,o){var u=vf(n,e,t,r,o);Ff(n,u)},Hf=function(s,n){return Cf(s,n).match({ltr:function(n,e,t,r){Lf(s,n,e,t,r)},rtl:function(c,a,l,f){Wf(s).each(function(n){if(n.setBaseAndExtent)n.setBaseAndExtent(c.dom,a,l.dom,f);else if(n.extend)try{t=c,r=a,o=l,u=f,(e=n).collapse(t.dom,r),e.extend(o.dom,u)}catch(i){Lf(s,l,f,c,a)}else Lf(s,l,f,c,a);var e,t,r,o,u})}})},qf=function(n,e,t,r,o){var u=_f(e,t,r,o);Hf(n,u)},Vf=function(n,e,t){var r=jf(e,t);Hf(n,r)},Uf=function(n){var o=gf.getWin(n).dom,e=function(n,e,t,r){return vf(o,n,e,t,r)},t=n.match({domRange:function(n){var e=Dn.fromDom(n.startContainer),t=Dn.fromDom(n.endContainer);return _f(e,n.startOffset,t,n.endOffset)},relative:jf,exact:_f});return Cf(o,t).match({ltr:e,rtl:e})},$f=function(n){if(0<n.rangeCount){var e=n.getRangeAt(0),t=n.getRangeAt(n.rangeCount-1);return S.some(ff(Dn.fromDom(e.startContainer),e.startOffset,Dn.fromDom(t.endContainer),t.endOffset))}return S.none()},Gf=function(n){if(null===n.anchorNode||null===n.focusNode)return $f(n);var e=Dn.fromDom(n.anchorNode),t=Dn.fromDom(n.focusNode);return zf(e,n.anchorOffset,t,n.focusOffset)?S.some(ff(e,n.anchorOffset,t,n.focusOffset)):$f(n)},Kf=function(n,e){var t,r,o=(t=e,r=n.document.createRange(),pf(r,t),r);Ff(n,o)},Xf=function(n){return Wf(n).filter(function(n){return 0<n.rangeCount}).bind(Gf).map(function(n){return gf.exact(n.start,n.soffset,n.finish,n.foffset)})},Yf=function(n,e){var t,r,o,u=Sf(n,e);return r=(t=u).getClientRects(),0<(o=0<r.length?r[0]:t.getBoundingClientRect()).width||0<o.height?S.some(o).map(bf):S.none()},Jf=function(n,e,t){return r=n,o=e,u=t,i=Dn.fromDom(r.document),Mf(i,o,u).map(function(n){return ff(Dn.fromDom(n.startContainer),n.startOffset,Dn.fromDom(n.endContainer),n.endOffset)});var r,o,u,i},Qf=tinymce.util.Tools.resolve("tinymce.util.VK"),Zf=function(n,e,t,r){return ts(n,e,lf(o=t,u).fold(function(){return af.none(o)},function(n){return n.index+1<n.all.length?af.middle(o,n.all[n.index+1]):af.last(o)}),r);var o,u},ns=function(n,e,t,r){return ts(n,e,lf(o=t,u).fold(function(){return af.none()},function(n){return 0<=n.index-1?af.middle(o,n.all[n.index-1]):af.first(o)}),r);var o,u},es=function(n,e){var t=gf.exact(e,0,e,0);return Uf(t)},ts=function(o,n,e,u){return e.fold(S.none,S.none,function(n,e){return sr(e).map(function(n){return es(0,n)})},function(r){return et(r,n).bind(function(n){var e,t=kr(r);return o.undoManager.transact(function(){u.insertRowsAfter(n,t)}),e=Ce(n,"tr"),F(e).bind(function(n){return De(n,"td,th").map(function(n){return es(0,n)})})})})},rs=["table","li","dl"],os=function(e,t,r){var o,u,n,i;e.keyCode===Qf.TAB&&(o=Vi(t),u=function(n){var e=Gn(n);return Bn(n,o)||D(rs,e)},(n=t.selection.getRng()).collapsed&&(i=Dn.fromDom(n.startContainer),Qe(i,u).each(function(n){e.preventDefault(),(e.shiftKey?ns:Zf)(t,u,n,r).each(function(n){t.selection.setRng(n)})})))},us=function(n,e){return{selection:n,kill:e}},is=function(n,e,t,r){return{start:df.on(n,e),finish:df.on(t,r)}},cs=function(n,e){var t=Sf(n,e);return ff(Dn.fromDom(t.startContainer),t.startOffset,Dn.fromDom(t.endContainer),t.endOffset)},as=is,ls=function(t,n,r,e,o){return Bn(r,e)?S.none():$t(r,e,n).bind(function(n){var e=n.boxes.getOr([]);return 0<e.length?(o(t,e,n.start,n.finish),S.some(us(S.some(as(r,0,r,ar(r))),!0))):S.none()})},fs=function(n,e){return{item:n,mode:e}},ss=function(n,e,t,r){return void 0===r&&(r=ds),n.property().parent(e).map(function(n){return fs(n,r)})},ds=function(n,e,t,r){return void 0===r&&(r=ms),t.sibling(n,e).map(function(n){return fs(n,r)})},ms=function(n,e,t,r){void 0===r&&(r=ms);var o=n.property().children(e);return t.first(o).map(function(n){return fs(n,r)})},gs=[{current:ss,next:ds,fallback:S.none()},{current:ds,next:ms,fallback:S.some(ss)},{current:ms,next:ms,fallback:S.some(ds)}],ps=function(e,t,r,o,n){return void 0===n&&(n=gs),M(n,function(n){return n.current===r}).bind(function(n){return n.current(e,t,o,n.next).orThunk(function(){return n.fallback.bind(function(n){return ps(e,t,n,o)})})})},hs=function(){return{sibling:function(n,e){return n.query().prevSibling(e)},first:function(n){return 0<n.length?S.some(n[n.length-1]):S.none()}}},vs=function(){return{sibling:function(n,e){return n.query().nextSibling(e)},first:function(n){return 0<n.length?S.some(n[0]):S.none()}}},bs=function(e,n,t,r,o,u){return ps(e,n,r,o).bind(function(n){return u(n.item)?S.none():t(n.item)?S.some(n.item):bs(e,n.item,t,n.mode,o,u)})},ws=function(e){return function(n){return 0===e.property().children(n).length}},ys=function(n,e,t,r){return bs(n,e,t,ds,hs(),r)},Cs=function(n,e,t,r){return bs(n,e,t,ds,vs(),r)},Ss=zt(),xs=function(n,e){return ys(t=Ss,n,ws(t),e);var t},Ts=function(n,e){return Cs(t=Ss,n,ws(t),e);var t},Rs=Qt([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),Ds=function(n){return Oe(n,"tr")},Os=H(H({},Rs),{verify:function(c,n,e,t,r,a,o){return Oe(t,"td,th",o).bind(function(i){return Oe(n,"td,th",o).map(function(u){return Bn(i,u)?Bn(t,i)&&ar(i)===r?a(u):Rs.none("in same cell"):Vt(Ds,[i,u]).fold(function(){return e=u,t=i,r=(n=c).getRect(e),(o=n.getRect(t)).right>r.left&&o.left<r.right?Rs.success():a(u);var n,e,t,r,o},function(n){return a(u)})})}).getOr(Rs.none("default"))},cata:function(n,e,t,r,o){return n.fold(e,t,r,o)}}),As=function(n,e){return N(n,w(Bn,e))},Bs=function(n){return"br"===Gn(n)},Es=function(n,e,t){return e(n,t).bind(function(n){return Qn(n)&&0===Mt(n).trim().length?Es(n,e,t):S.some(n)})},Is=function(e,n,t,r){return ae(o=n,u=t).filter(Bs).orThunk(function(){return ae(o,u-1).filter(Bs)}).bind(function(n){return r.traverse(n).fold(function(){return Es(n,r.gather,e).map(r.relative)},function(n){return re(r=n).bind(function(e){var t=ce(e);return As(t,r).map(function(n){return{parent:e,children:t,element:r,index:n}})}).map(function(n){return df.on(n.parent,n.index)});var r})});var o,u},Ps=function(n,e,t,r){var o,u,i;return(Bs(e)?(o=n,u=e,(i=r).traverse(u).orThunk(function(){return Es(u,i.gather,o)}).map(i.relative)):Is(n,e,t,r)).map(function(n){return{start:n,finish:n}})},ks=function(n,e){return{left:n.left,top:n.top+e,right:n.right,bottom:n.bottom+e}},Ms=function(n,e){return{left:n.left,top:n.top-e,right:n.right,bottom:n.bottom-e}},Ns=function(n,e,t){return{left:n.left+e,top:n.top+t,right:n.right+e,bottom:n.bottom+t}},js=function(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom}},_s=function(n,e){return S.some(n.getRect(e))},zs=function(n,e,t){return Jn(e)?_s(n,e).map(js):Qn(e)?(r=n,o=e,(0<=(u=t)&&u<ar(o)?r.getRangedRect(o,u,o,u+1):0<u?r.getRangedRect(o,u-1,o,u):S.none()).map(js)):S.none();var r,o,u},Ws=function(n,e){return Jn(e)?_s(n,e).map(js):Qn(e)?n.getRangedRect(e,0,e,ar(e)).map(js):S.none()},Fs=Qt([{none:[]},{retry:["caret"]}]),Ls=function(e,n,r){return Se(function(n,e){return e(n)},xe,n,ya,t).fold(f,function(n){return Ws(e,n).exists(function(n){return t=n,(e=r).left<t.left||Math.abs(t.right-e.left)<1||e.left>t.right;var e,t})});var t},Hs={point:function(n){return n.bottom},adjuster:function(n,e,t,r,o){var u=ks(o,5);return Math.abs(t.bottom-r.bottom)<1||t.top>o.bottom?Fs.retry(u):t.top===o.bottom?Fs.retry(ks(o,1)):Ls(n,e,o)?Fs.retry(Ns(u,5,0)):Fs.none()},move:ks,gather:Ts},qs=function(t,r,o,u,i){return 0===i?S.some(u):(a=t,l=u.left,f=r.point(u),a.elementFromPoint(l,f).filter(function(n){return"table"===Gn(n)}).isSome()?(e=u,c=i-1,qs(t,n=r,o,n.move(e,5),c)):t.situsFromPoint(u.left,r.point(u)).bind(function(n){return n.start.fold(S.none,function(e){return Ws(t,e).bind(function(n){return r.adjuster(t,e,n,o,u).fold(S.none,function(n){return qs(t,r,o,n,i-1)})}).orThunk(function(){return S.some(u)})},S.none)}));var n,e,c,a,l,f},Vs=function(e,t,n){var r,o,u,i=e.move(n,5),c=qs(t,e,n,i,100).getOr(i);return o=c,u=t,((r=e).point(o)>u.getInnerHeight()?S.some(r.point(o)-u.getInnerHeight()):r.point(o)<0?S.some(-r.point(o)):S.none()).fold(function(){return t.situsFromPoint(c.left,e.point(c))},function(n){return t.scrollBy(0,n),t.situsFromPoint(c.left,e.point(c)-n)})},Us={tryUp:w(Vs,{point:function(n){return n.top},adjuster:function(n,e,t,r,o){var u=Ms(o,5);return Math.abs(t.top-r.top)<1||t.bottom<o.top?Fs.retry(u):t.bottom===o.top?Fs.retry(Ms(o,1)):Ls(n,e,o)?Fs.retry(Ns(u,5,0)):Fs.none()},move:Ms,gather:xs}),tryDown:w(Vs,Hs),ieTryUp:function(n,e){return n.situsFromPoint(e.left,e.top-5)},ieTryDown:function(n,e){return n.situsFromPoint(e.left,e.bottom+5)},getJumpSize:b(5)},$s=function(u,i,c){return u.getSelection().bind(function(o){return Ps(i,o.finish,o.foffset,c).fold(function(){return S.some(hc(o.finish,o.foffset))},function(n){var e,t=u.fromSitus(n),r=Os.verify(u,o.finish,o.foffset,t.finish,t.foffset,c.failure,i);return e=r,Os.cata(e,function(n){return S.none()},function(){return S.none()},function(n){return S.some(hc(n,0))},function(n){return S.some(hc(n,ar(n)))})})})},Gs=function(r,o,u,i,c,a){return 0===a?S.none():Ys(r,o,u,i,c).bind(function(n){var e=r.fromSitus(n),t=Os.verify(r,u,i,e.finish,e.foffset,c.failure,o);return Os.cata(t,function(){return S.none()},function(){return S.some(n)},function(n){return Bn(u,n)&&0===i?Ks(r,u,i,Ms,c):Gs(r,o,n,0,c,a-1)},function(n){return Bn(u,n)&&i===ar(n)?Ks(r,u,i,ks,c):Gs(r,o,n,ar(n),c,a-1)})})},Ks=function(e,n,t,r,o){return zs(e,n,t).bind(function(n){return Xs(e,o,r(n,Us.getJumpSize()))})},Xs=function(n,e,t){var r=Tn().browser;return r.isChrome()||r.isSafari()||r.isFirefox()||r.isEdge()?e.otherRetry(n,t):r.isIE()?e.ieRetry(n,t):S.none()},Ys=function(e,n,t,r,o){return zs(e,t,r).bind(function(n){return Xs(e,o,n)})},Js=function(n,e){return xe(n,function(n){return re(n).exists(function(n){return Bn(n,e)})},t).isSome();var t},Qs=function(u,i,c,n,a){return Oe(n,"td,th",i).bind(function(o){return Oe(o,"table",i).bind(function(n){return Js(a,n)?$s(e=u,t=i,r=c).bind(function(n){return Gs(e,t,n.element,n.offset,r,20).map(e.fromSitus)}).bind(function(e){return Oe(e.finish,"td,th",i).map(function(n){return{start:o,finish:n,range:e}})}):S.none();var e,t,r})})},Zs=function(n,e,t,r,o,u){return Tn().browser.isIE()?S.none():u(r,e).orThunk(function(){return Qs(n,e,t,r,o).map(function(n){var e=n.range;return us(S.some(as(e.start,e.soffset,e.finish,e.foffset)),!0)})})},nd=function(n,r){return Oe(n,"tr",r).bind(function(t){return Oe(t,"table",r).bind(function(n){var e=Ce(n,"tr");return Bn(t,e[0])?ys(Ss,n,function(n){return dr(n).isSome()},r).map(function(n){var e=ar(n);return us(S.some(as(n,e,n,e)),!0)}):S.none()})})},ed=function(n,r){return Oe(n,"tr",r).bind(function(t){return Oe(t,"table",r).bind(function(n){var e=Ce(n,"tr");return Bn(t,e[e.length-1])?Cs(Ss,n,function(n){return sr(n).isSome()},r).map(function(n){return us(S.some(as(n,0,n,0)),!0)}):S.none()})})},td=function(n,e,t,r,o,u,i){return Qs(n,t,r,o,u).bind(function(n){return ls(e,t,n.start,n.finish,i)})},rd=function(n,e){return Oe(n,"td,th",e)};function od(o,u,e,i){var t,r=(t=Zi(S.none()),{clear:function(){return t.set(S.none())},set:function(n){return t.set(S.some(n))},isSet:function(){return t.get().isSome()},on:function(n){return t.get().each(n)}}),c=r.clear;return{clearstate:c,mousedown:function(n){i.clear(u),rd(n.target,e).each(r.set)},mouseover:function(n){r.on(function(r){i.clearBeforeUpdate(u),rd(n.target,e).each(function(t){$t(r,t,e).each(function(n){var e=n.boxes.getOr([]);(1<e.length||1===e.length&&!Bn(r,t))&&(i.selectRange(u,e,n.start,n.finish),o.selectContents(t))})})})},mouseup:function(n){c()}}}var ud={traverse:ie,gather:Ts,relative:df.before,otherRetry:Us.tryDown,ieRetry:Us.ieTryDown,failure:Os.failedDown},id={traverse:ue,gather:xs,relative:df.before,otherRetry:Us.tryUp,ieRetry:Us.ieTryUp,failure:Os.failedUp},cd=function(e){return function(n){return n===e}},ad=cd(38),ld=cd(40),fd=function(n){return 37<=n&&n<=40},sd={isBackward:cd(37),isForward:cd(39)},dd={isBackward:cd(39),isForward:cd(37)},md=function(c){return{elementFromPoint:function(n,e){return Dn.fromPoint(Dn.fromDom(c.document),n,e)},getRect:function(n){return n.dom.getBoundingClientRect()},getRangedRect:function(n,e,t,r){var o=gf.exact(n,e,t,r);return Yf(c,o)},getSelection:function(){return Xf(c).map(function(n){return cs(c,n)})},fromSitus:function(n){var e=gf.relative(n.start,n.finish);return cs(c,e)},situsFromPoint:function(n,e){return Jf(c,n,e).map(function(n){return is(n.start,n.soffset,n.finish,n.foffset)})},clearSelection:function(){Wf(c).each(function(n){return n.removeAllRanges()})},collapseSelection:function(i){void 0===i&&(i=!1),Xf(c).each(function(n){return n.fold(function(n){return n.collapse(i)},function(n,e){var t=i?n:e;Vf(c,t,t)},function(n,e,t,r){var o=i?n:t,u=i?e:r;qf(c,o,u,o,u)})})},setSelection:function(n){qf(c,n.start,n.soffset,n.finish,n.foffset)},setRelativeSelection:function(n,e){Vf(c,n,e)},selectContents:function(n){Kf(c,n)},getInnerHeight:function(){return c.innerHeight},getScrollY:function(){var n,e,t,r;return(n=Dn.fromDom(c.document),e=n!==undefined?n.dom:document,t=e.body.scrollLeft||e.documentElement.scrollLeft,r=e.body.scrollTop||e.documentElement.scrollTop,no(t,r)).top},scrollBy:function(n,e){var t,r,o,u;t=n,r=e,o=Dn.fromDom(c.document),(u=(o!==undefined?o.dom:document).defaultView)&&u.scrollBy(t,r)}}},gd=function(n,e){return{rows:n,cols:e}},pd=function(n,e,t,r){var o=od(md(n),e,t,r);return{clearstate:o.clearstate,mousedown:o.mousedown,mouseover:o.mouseover,mouseup:o.mouseup}},hd=function(n,g,p,h){var l=md(n),f=function(){return h.clear(g),S.none()};return{keydown:function(n,e,t,r,o,i){var u=n.raw,c=u.which,a=!0===u.shiftKey;return Gt(g,h.selectedSelector).fold(function(){return ld(c)&&a?w(td,l,g,p,ud,r,e,h.selectRange):ad(c)&&a?w(td,l,g,p,id,r,e,h.selectRange):ld(c)?w(Zs,l,p,ud,r,e,ed):ad(c)?w(Zs,l,p,id,r,e,nd):S.none},function(u){var n=function(n){return function(){return L(n,function(n){return e=n.rows,t=n.cols,r=g,Xt(u,e,t,(o=h).firstSelectedSelector,o.lastSelectedSelector).map(function(n){return o.clearBeforeUpdate(r),o.selectRange(r,n.boxes,n.start,n.finish),n.boxes});var e,t,r,o}).fold(function(){return Kt(g,h.firstSelectedSelector,h.lastSelectedSelector).map(function(n){var e=ld(c)||i.isForward(c)?df.after:df.before;return l.setRelativeSelection(df.on(n.first,0),e(n.table)),h.clear(g),us(S.none(),!0)})},function(n){return S.some(us(S.none(),!0))})}};return ld(c)&&a?n([gd(1,0)]):ad(c)&&a?n([gd(-1,0)]):i.isBackward(c)&&a?n([gd(0,-1),gd(-1,0)]):i.isForward(c)&&a?n([gd(0,1),gd(1,0)]):fd(c)&&!1==a?f:S.none})()},keyup:function(l,f,s,d,m){return Gt(g,h.selectedSelector).fold(function(){var t,r,n,e,o,u,i,c=l.raw,a=c.which;return!1!=(!0===c.shiftKey)&&fd(a)?(t=g,r=p,n=f,e=s,o=d,u=m,i=h.selectRange,Bn(n,o)&&e===u?S.none():Oe(n,"td,th",r).bind(function(e){return Oe(o,"td,th",r).bind(function(n){return ls(t,r,e,n,i)})})):S.none()},S.none)}}},vd=function(n,r,e,o){var u=md(n);return function(n,t){o.clearBeforeUpdate(r),$t(n,t,e).each(function(n){var e=n.boxes.getOr([]);o.selectRange(r,e,n.start,n.finish),u.selectContents(t),u.collapseSelection()})}},bd=function(r,n){E(n,function(n){var e,t;t=n,$u(e=r)?e.dom.classList.remove(t):Ku(e,t),Yu(e)})},wd={byClass:function(o){var e,t,u=(e=o.selected,function(n){Xu(n,e)}),r=(t=[o.selected,o.lastSelected,o.firstSelected],function(n){bd(n,t)}),i=function(n){var e=Ce(n,o.selectedSelector);E(e,r)};return{clearBeforeUpdate:i,clear:i,selectRange:function(n,e,t,r){i(n),E(e,u),Xu(t,o.firstSelected),Xu(r,o.lastSelected)},selectedSelector:o.selectedSelector,firstSelectedSelector:o.firstSelectedSelector,lastSelectedSelector:o.lastSelectedSelector}},byAttr:function(o,u,e){var t=function(n){ke(n,o.selected),ke(n,o.firstSelected),ke(n,o.lastSelected)},i=function(n){Be(n,o.selected,"1")},c=function(n){r(n),e()},r=function(n){var e=Ce(n,o.selectedSelector);E(e,t)};return{clearBeforeUpdate:r,clear:c,selectRange:function(n,e,t,r){c(n),E(e,i),Be(t,o.firstSelected,"1"),Be(r,o.lastSelected,"1"),u(e,t,r)},selectedSelector:o.selectedSelector,firstSelectedSelector:o.firstSelectedSelector,lastSelectedSelector:o.lastSelectedSelector}}},yd=function(n,e,s){var d=ft.fromTable(n);return Vc(d,e).map(function(n){var t,e,r,o,u,i,c,a,l,f=_c(d,s,!1);return{upOrLeftCells:(t=n,e=s,r=f.slice(0,t[t.length-1].row+1),o=Wc(r,e),_(o,function(n){var e=n.cells.slice(0,t[t.length-1].column+1);return B(e,function(n){return n.element})})),downOrRightCells:(i=n,c=s,a=(u=f).slice(i[0].row+i[0].rowspan-1,u.length),l=Wc(a,c),_(l,function(n){var e=n.cells.slice(i[0].column+i[0].colspan-1,n.cells.length);return B(e,function(n){return n.element})}))}})},Cd=function(n){return!1===Ju(Dn.fromDom(n.target),"ephox-snooker-resizer-bar")};function Sd(d,m,n){var g=wd.byAttr(Pr,function(u,i,c){n.targets().each(function(o){et(i).each(function(n){var e=Hi(d),t=Rr(y,Dn.fromDom(d.getDoc()),e),r=yd(n,o,t);Ci(d,u,i,c,r)})})},function(){return Si(d)});return d.on("init",function(n){var r=d.getWin(),o=Vi(d),e=Gi(d),t=pd(r,o,e,g),i=hd(r,o,e,g),u=vd(r,o,e,g);d.on("TableSelectorChange",function(n){return u(n.start,n.finish)});var c,a,l=function(n,e){!0===n.raw.shiftKey&&(e.kill&&n.kill(),e.selection.each(function(n){var e=gf.relative(n.start,n.finish),t=Sf(r,e);d.selection.setRng(t)}))},f=function(n){return 0===n.button},s=(c=Zi(Dn.fromDom(o)),a=Zi(0),{touchEnd:function(n){var e,t,r=Dn.fromDom(n.target);"td"!==Gn(r)&&"th"!==Gn(r)||(e=c.get(),t=a.get(),Bn(e,r)&&n.timeStamp-t<300&&(n.preventDefault(),u(r,r))),c.set(r),a.set(n.timeStamp)}});d.on("dragstart",function(n){t.clearstate()}),d.on("mousedown",function(n){f(n)&&Cd(n)&&t.mousedown(Vu(n))}),d.on("mouseover",function(n){var e;((e=n).buttons===undefined||Xl.browser.isEdge()&&0===e.buttons||0!=(1&e.buttons))&&Cd(n)&&t.mouseover(Vu(n))}),d.on("mouseup",function(n){f(n)&&Cd(n)&&t.mouseup(Vu(n))}),d.on("touchend",s.touchEnd),d.on("keyup",function(n){var e,t,r,o=Vu(n);o.raw.shiftKey&&fd(o.raw.which)&&(e=d.selection.getRng(),t=Dn.fromDom(e.startContainer),r=Dn.fromDom(e.endContainer),i.keyup(o,t,e.startOffset,r,e.endOffset).each(function(n){l(o,n)}))}),d.on("keydown",function(n){var e=Vu(n);m().each(function(n){return n.hideBars()});var t=d.selection.getRng(),r=Dn.fromDom(t.startContainer),o=Dn.fromDom(t.endContainer),u=qr(sd,dd)(Dn.fromDom(d.selection.getStart()));i.keydown(e,r,t.startOffset,o,t.endOffset,u).each(function(n){l(e,n)}),m().each(function(n){return n.showBars()})}),d.on("NodeChange",function(){var n=d.selection,e=Dn.fromDom(n.getStart()),t=Dn.fromDom(n.getEnd());Vt(et,[e,t]).fold(function(){return g.clear(o)},y)})}),{clear:g.clear}}var xd=function(n,t){var o=Zi(S.none()),u=Zi([]),e=function(){return ol(Qi(n)).bind(function(e){var n=et(e);return n.map(function(n){return"caption"===Gn(e)?kr(e):Mr(t,n,e)})})},r=function(){o.set(U(e)()),E(u.get(),function(n){return n()})},i=function(e,t){var r=function(){return o.get().fold(function(){e.setDisabled(!0)},function(n){e.setDisabled(t(n))})};return r(),u.set(u.get().concat([r])),function(){u.set(I(u.get(),function(n){return n!==r}))}};return n.on("NodeChange ExecCommand TableSelectorChange",r),{onSetupTable:function(n){return i(n,function(n){return!1})},onSetupCellOrRow:function(n){return i(n,function(n){return"caption"===Gn(n.element)})},onSetupPasteable:function(e){return function(n){return i(n,function(n){return"caption"===Gn(n.element)||e().isNone()})}},onSetupMergeable:function(n){return i(n,function(n){return n.mergable.isNone()})},onSetupUnmergeable:function(n){return i(n,function(n){return n.unmergable.isNone()})},resetTargets:r,targets:function(){return o.get()}}},Td=function(e,n,t){e.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:function(n){return n("inserttable | cell row column | advtablesort | tableprops deletetable")}});var r=function(n){return function(){return e.execCommand(n)}};e.ui.registry.addButton("tableprops",{tooltip:"Table properties",onAction:r("mceTableProps"),icon:"table",onSetup:n.onSetupTable}),e.ui.registry.addButton("tabledelete",{tooltip:"Delete table",onAction:r("mceTableDelete"),icon:"table-delete-table",onSetup:n.onSetupTable}),e.ui.registry.addButton("tablecellprops",{tooltip:"Cell properties",onAction:r("mceTableCellProps"),icon:"table-cell-properties",onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tablemergecells",{tooltip:"Merge cells",onAction:r("mceTableMergeCells"),icon:"table-merge-cells",onSetup:n.onSetupMergeable}),e.ui.registry.addButton("tablesplitcells",{tooltip:"Split cell",onAction:r("mceTableSplitCells"),icon:"table-split-cells",onSetup:n.onSetupUnmergeable}),e.ui.registry.addButton("tableinsertrowbefore",{tooltip:"Insert row before",onAction:r("mceTableInsertRowBefore"),icon:"table-insert-row-above",onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tableinsertrowafter",{tooltip:"Insert row after",onAction:r("mceTableInsertRowAfter"),icon:"table-insert-row-after",onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tabledeleterow",{tooltip:"Delete row",onAction:r("mceTableDeleteRow"),icon:"table-delete-row",onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tablerowprops",{tooltip:"Row properties",onAction:r("mceTableRowProps"),icon:"table-row-properties",onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tableinsertcolbefore",{tooltip:"Insert column before",onAction:r("mceTableInsertColBefore"),icon:"table-insert-column-before",onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tableinsertcolafter",{tooltip:"Insert column after",onAction:r("mceTableInsertColAfter"),icon:"table-insert-column-after",onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tabledeletecol",{tooltip:"Delete column",onAction:r("mceTableDeleteCol"),icon:"table-delete-column",onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tablecutrow",{tooltip:"Cut row",icon:"cut-row",onAction:r("mceTableCutRow"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tablecopyrow",{tooltip:"Copy row",icon:"duplicate-row",onAction:r("mceTableCopyRow"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tablepasterowbefore",{tooltip:"Paste row before",icon:"paste-row-before",onAction:r("mceTablePasteRowBefore"),onSetup:n.onSetupPasteable(t.getRows)}),e.ui.registry.addButton("tablepasterowafter",{tooltip:"Paste row after",icon:"paste-row-after",onAction:r("mceTablePasteRowAfter"),onSetup:n.onSetupPasteable(t.getRows)}),e.ui.registry.addButton("tablecutcol",{tooltip:"Cut column",icon:"cut-column",onAction:r("mceTableCutCol"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tablecopycol",{tooltip:"Copy column",icon:"duplicate-column",onAction:r("mceTableCopyCol"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tablepastecolbefore",{tooltip:"Paste column before",icon:"paste-column-before",onAction:r("mceTablePasteColBefore"),onSetup:n.onSetupPasteable(t.getColumns)}),e.ui.registry.addButton("tablepastecolafter",{tooltip:"Paste column after",icon:"paste-column-after",onAction:r("mceTablePasteColAfter"),onSetup:n.onSetupPasteable(t.getColumns)}),e.ui.registry.addButton("tableinsertdialog",{tooltip:"Insert table",onAction:r("mceInsertTable"),icon:"table"})},Rd=function(e){var n=e.getParam("table_toolbar","tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol");0<n.length&&e.ui.registry.addContextToolbar("table",{predicate:function(n){return e.dom.is(n,"table")&&e.getBody().contains(n)},items:n,scope:"node",position:"node"})},Dd=function(r,n,e){var t=function(n){return function(){return r.execCommand(n)}},o=function(n){var e=n.numRows,t=n.numColumns;r.undoManager.transact(function(){ml(r,t,e,0,0)}),r.addVisual()},u={text:"Table properties",onSetup:n.onSetupTable,onAction:t("mceTableProps")},i={text:"Delete table",icon:"table-delete-table",onSetup:n.onSetupTable,onAction:t("mceTableDelete")};r.ui.registry.addMenuItem("tableinsertrowbefore",{text:"Insert row before",icon:"table-insert-row-above",onAction:t("mceTableInsertRowBefore"),onSetup:n.onSetupCellOrRow}),r.ui.registry.addMenuItem("tableinsertrowafter",{text:"Insert row after",icon:"table-insert-row-after",onAction:t("mceTableInsertRowAfter"),onSetup:n.onSetupCellOrRow}),r.ui.registry.addMenuItem("tabledeleterow",{text:"Delete row",icon:"table-delete-row",onAction:t("mceTableDeleteRow"),onSetup:n.onSetupCellOrRow}),r.ui.registry.addMenuItem("tablerowprops",{text:"Row properties",icon:"table-row-properties",onAction:t("mceTableRowProps"),onSetup:n.onSetupCellOrRow}),r.ui.registry.addMenuItem("tablecutrow",{text:"Cut row",icon:"cut-row",onAction:t("mceTableCutRow"),onSetup:n.onSetupCellOrRow}),r.ui.registry.addMenuItem("tablecopyrow",{text:"Copy row",icon:"duplicate-row",onAction:t("mceTableCopyRow"),onSetup:n.onSetupCellOrRow}),r.ui.registry.addMenuItem("tablepasterowbefore",{text:"Paste row before",icon:"paste-row-before",onAction:t("mceTablePasteRowBefore"),onSetup:n.onSetupPasteable(e.getRows)}),r.ui.registry.addMenuItem("tablepasterowafter",{text:"Paste row after",icon:"paste-row-after",onAction:t("mceTablePasteRowAfter"),onSetup:n.onSetupPasteable(e.getRows)});r.ui.registry.addMenuItem("tableinsertcolumnbefore",{text:"Insert column before",icon:"table-insert-column-before",onAction:t("mceTableInsertColBefore"),onSetup:n.onSetupCellOrRow}),r.ui.registry.addMenuItem("tableinsertcolumnafter",{text:"Insert column after",icon:"table-insert-column-after",onAction:t("mceTableInsertColAfter"),onSetup:n.onSetupCellOrRow}),r.ui.registry.addMenuItem("tabledeletecolumn",{text:"Delete column",icon:"table-delete-column",onAction:t("mceTableDeleteCol"),onSetup:n.onSetupCellOrRow}),r.ui.registry.addMenuItem("tablecutcolumn",{text:"Cut column",icon:"cut-column",onAction:t("mceTableCutCol"),onSetup:n.onSetupCellOrRow}),r.ui.registry.addMenuItem("tablecopycolumn",{text:"Copy column",icon:"duplicate-column",onAction:t("mceTableCopyCol"),onSetup:n.onSetupCellOrRow}),r.ui.registry.addMenuItem("tablepastecolumnbefore",{text:"Paste column before",icon:"paste-column-before",onAction:t("mceTablePasteColBefore"),onSetup:n.onSetupPasteable(e.getColumns)}),r.ui.registry.addMenuItem("tablepastecolumnafter",{text:"Paste column after",icon:"paste-column-after",onAction:t("mceTablePasteColAfter"),onSetup:n.onSetupPasteable(e.getColumns)});r.ui.registry.addMenuItem("tablecellprops",{text:"Cell properties",icon:"table-cell-properties",onAction:t("mceTableCellProps"),onSetup:n.onSetupCellOrRow}),r.ui.registry.addMenuItem("tablemergecells",{text:"Merge cells",icon:"table-merge-cells",onAction:t("mceTableMergeCells"),onSetup:n.onSetupMergeable}),r.ui.registry.addMenuItem("tablesplitcells",{text:"Split cell",icon:"table-split-cells",onAction:t("mceTableSplitCells"),onSetup:n.onSetupUnmergeable});!1===r.getParam("table_grid",!0,"boolean")?r.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:t("mceInsertTable")}):r.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"inserttable",onAction:o}]}}),r.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:t("mceInsertTable")}),r.ui.registry.addMenuItem("tableprops",u),r.ui.registry.addMenuItem("deletetable",i),r.ui.registry.addNestedMenuItem("row",{type:"nestedmenuitem",text:"Row",getSubmenuItems:function(){return"tableinsertrowbefore tableinsertrowafter tabledeleterow tablerowprops | tablecutrow tablecopyrow tablepasterowbefore tablepasterowafter"}}),r.ui.registry.addNestedMenuItem("column",{type:"nestedmenuitem",text:"Column",getSubmenuItems:function(){return"tableinsertcolumnbefore tableinsertcolumnafter tabledeletecolumn | tablecutcolumn tablecopycolumn tablepastecolumnbefore tablepastecolumnafter"}}),r.ui.registry.addNestedMenuItem("cell",{type:"nestedmenuitem",text:"Cell",getSubmenuItems:function(){return"tablecellprops tablemergecells tablesplitcells"}}),r.ui.registry.addContextMenu("table",{update:function(){return n.resetTargets(),n.targets().fold(function(){return""},function(n){return"caption"===Gn(n.element)?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"})}})};function Od(e){var n=or(function(){return Vi(e)},function(){return ol(Qi(e))},Pr.selectedSelector),t=xd(e,n),r=pc(e),o=Sd(e,r.lazyResize,t),u=cl(e,r.lazyWire,n),i=rf();return ef(e,u,o,n,i),tf(e,u,n),Nr(e,n,u,o),Dd(e,t,i),Td(e,t,i),Rd(e),e.on("PreInit",function(){e.serializer.addTempAttr(Pr.firstSelected),e.serializer.addTempAttr(Pr.lastSelected),uf(e)}),Ii(e)&&e.on("keydown",function(n){os(n,e,u)}),e.on("remove",function(){r.destroy()}),vl(e,i,r,t)}ur.add("table",Od)}();